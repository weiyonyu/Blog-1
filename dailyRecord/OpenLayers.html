<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>OpenLayers åŸºç¡€ | Notebook</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="">
    <meta name="description" content="ğŸ“æ¯å¤©è®°å½•ä¸€ç‚¹ç‚¹">
    
    <link rel="preload" href="./assets/css/0.styles.81cbcbf8.css" as="style"><link rel="preload" href="./assets/js/app.78793606.js" as="script"><link rel="preload" href="./assets/js/3.9a8cb714.js" as="script"><link rel="preload" href="./assets/js/37.64bf3a08.js" as="script"><link rel="preload" href="./assets/js/17.7a89769a.js" as="script"><link rel="prefetch" href="./assets/js/10.3f7afedc.js"><link rel="prefetch" href="./assets/js/11.849f2ab3.js"><link rel="prefetch" href="./assets/js/12.f69c7e94.js"><link rel="prefetch" href="./assets/js/13.ab50e66a.js"><link rel="prefetch" href="./assets/js/14.4b2fce32.js"><link rel="prefetch" href="./assets/js/15.8b353502.js"><link rel="prefetch" href="./assets/js/16.3195875f.js"><link rel="prefetch" href="./assets/js/18.fcadf835.js"><link rel="prefetch" href="./assets/js/19.231d3618.js"><link rel="prefetch" href="./assets/js/2.56707d7e.js"><link rel="prefetch" href="./assets/js/20.a85f560c.js"><link rel="prefetch" href="./assets/js/21.24336449.js"><link rel="prefetch" href="./assets/js/22.73659552.js"><link rel="prefetch" href="./assets/js/23.a091243a.js"><link rel="prefetch" href="./assets/js/24.c8ba16f0.js"><link rel="prefetch" href="./assets/js/25.882bb768.js"><link rel="prefetch" href="./assets/js/26.f04079ce.js"><link rel="prefetch" href="./assets/js/27.3ccd410f.js"><link rel="prefetch" href="./assets/js/28.58938703.js"><link rel="prefetch" href="./assets/js/29.a0b3a5cc.js"><link rel="prefetch" href="./assets/js/30.054f5cc9.js"><link rel="prefetch" href="./assets/js/31.2a2497ca.js"><link rel="prefetch" href="./assets/js/32.2fec2015.js"><link rel="prefetch" href="./assets/js/33.1c38360d.js"><link rel="prefetch" href="./assets/js/34.c6f368f7.js"><link rel="prefetch" href="./assets/js/35.eb21b972.js"><link rel="prefetch" href="./assets/js/36.d24643c3.js"><link rel="prefetch" href="./assets/js/38.9456e466.js"><link rel="prefetch" href="./assets/js/39.d6639e8e.js"><link rel="prefetch" href="./assets/js/4.3e5912c4.js"><link rel="prefetch" href="./assets/js/40.0be61706.js"><link rel="prefetch" href="./assets/js/41.83d228f2.js"><link rel="prefetch" href="./assets/js/42.4a8c6e1b.js"><link rel="prefetch" href="./assets/js/43.ed4184d6.js"><link rel="prefetch" href="./assets/js/44.84f96688.js"><link rel="prefetch" href="./assets/js/45.99c1db7a.js"><link rel="prefetch" href="./assets/js/46.38462d37.js"><link rel="prefetch" href="./assets/js/47.18ad8970.js"><link rel="prefetch" href="./assets/js/5.07eb40e3.js"><link rel="prefetch" href="./assets/js/6.be2121ec.js"><link rel="prefetch" href="./assets/js/7.198c5ca7.js"><link rel="prefetch" href="./assets/js/8.0d657d1b.js"><link rel="prefetch" href="./assets/js/9.35e5878d.js">
    <link rel="stylesheet" href="./assets/css/0.styles.81cbcbf8.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/./" class="home-link router-link-active"><!----> <span class="site-name">Notebook</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/./dailyRecord/" class="nav-link router-link-active">
  ğŸ“šå­¦ä¹ æ€»ç»“
</a></div><div class="nav-item"><a href="/./bookmark/" class="nav-link">
  ğŸ“Œä¹¦ç­¾æ•´ç†
</a></div><div class="nav-item"><a href="/./lint/" class="nav-link">
  âœ”ï¸ç¼–ç è§„èŒƒ&amp;ååŒå¼€å‘
</a></div><div class="nav-item"><a href="http://shooterblog.site/Learn-JS-Demo/%E5%89%8D%E7%AB%AF%E7%9F%A5%E8%AF%86%E5%9B%BE%E8%B0%B1/index.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ğŸ“–çŸ¥è¯†è„‘å›¾
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/./dailyRecord/" class="nav-link router-link-active">
  ğŸ“šå­¦ä¹ æ€»ç»“
</a></div><div class="nav-item"><a href="/./bookmark/" class="nav-link">
  ğŸ“Œä¹¦ç­¾æ•´ç†
</a></div><div class="nav-item"><a href="/./lint/" class="nav-link">
  âœ”ï¸ç¼–ç è§„èŒƒ&amp;ååŒå¼€å‘
</a></div><div class="nav-item"><a href="http://shooterblog.site/Learn-JS-Demo/%E5%89%8D%E7%AB%AF%E7%9F%A5%E8%AF%86%E5%9B%BE%E8%B0%B1/index.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ğŸ“–çŸ¥è¯†è„‘å›¾
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>å‰ç«¯æ¨¡å—åŒ–å’Œæ‰“åŒ…å·¥å…·</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>å‰ç«¯å¼‚å¸¸ç›‘æ§</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Vue3åŸç†</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Vue3æºç </span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>å†…åŠŸä¿®ç‚¼</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>æ€»ç»“</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>GIS</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/./dailyRecord/OpenLayers.html" aria-current="page" class="active sidebar-link">OpenLayers åŸºç¡€</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/./dailyRecord/OpenLayers.html#åœ°å›¾" class="sidebar-link">åœ°å›¾</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/./dailyRecord/OpenLayers.html#ol-map-åœ°å›¾" class="sidebar-link">ol/Mapï¼ˆåœ°å›¾ï¼‰</a></li><li class="sidebar-sub-header"><a href="/./dailyRecord/OpenLayers.html#ol-view-è§†å›¾" class="sidebar-link">ol/Viewï¼ˆè§†å›¾ï¼‰</a></li><li class="sidebar-sub-header"><a href="/./dailyRecord/OpenLayers.html#ol-proj-projection-åæ ‡ç³»" class="sidebar-link">ol/proj/Projectionï¼ˆåæ ‡ç³»ï¼‰</a></li><li class="sidebar-sub-header"><a href="/./dailyRecord/OpenLayers.html#ol-overlay-åœ°å›¾å¼¹çª—" class="sidebar-link">ol/Overlayï¼ˆåœ°å›¾å¼¹çª—ï¼‰</a></li></ul></li><li class="sidebar-sub-header"><a href="/./dailyRecord/OpenLayers.html#å›¾å±‚" class="sidebar-link">å›¾å±‚</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/./dailyRecord/OpenLayers.html#ol-layer-image" class="sidebar-link">ol/layer/Image</a></li><li class="sidebar-sub-header"><a href="/./dailyRecord/OpenLayers.html#ol-layer-tile" class="sidebar-link">ol/layer/Tile</a></li><li class="sidebar-sub-header"><a href="/./dailyRecord/OpenLayers.html#ol-source-xyz" class="sidebar-link">ol/source/XYZ</a></li><li class="sidebar-sub-header"><a href="/./dailyRecord/OpenLayers.html#ol-tilegrid-tilegrid" class="sidebar-link">ol/tilegrid/TileGrid</a></li><li class="sidebar-sub-header"><a href="/./dailyRecord/OpenLayers.html#arcgisåŠ¨æ€å›¾å±‚" class="sidebar-link">arcgisåŠ¨æ€å›¾å±‚</a></li><li class="sidebar-sub-header"><a href="/./dailyRecord/OpenLayers.html#arcgisåŠ¨æ€å›¾å±‚-ç±»åˆ‡ç‰‡" class="sidebar-link">arcgisåŠ¨æ€å›¾å±‚ï¼ˆç±»åˆ‡ç‰‡ï¼‰</a></li><li class="sidebar-sub-header"><a href="/./dailyRecord/OpenLayers.html#arcgisåˆ‡ç‰‡å›¾å±‚" class="sidebar-link">arcgisåˆ‡ç‰‡å›¾å±‚</a></li><li class="sidebar-sub-header"><a href="/./dailyRecord/OpenLayers.html#supermapåŠ¨æ€å›¾å±‚" class="sidebar-link">supermapåŠ¨æ€å›¾å±‚</a></li><li class="sidebar-sub-header"><a href="/./dailyRecord/OpenLayers.html#supermapåŠ¨æ€å›¾å±‚-ç±»åˆ‡ç‰‡" class="sidebar-link">supermapåŠ¨æ€å›¾å±‚ï¼ˆç±»åˆ‡ç‰‡ï¼‰</a></li><li class="sidebar-sub-header"><a href="/./dailyRecord/OpenLayers.html#supermapåˆ‡ç‰‡å›¾å±‚" class="sidebar-link">supermapåˆ‡ç‰‡å›¾å±‚</a></li></ul></li><li class="sidebar-sub-header"><a href="/./dailyRecord/OpenLayers.html#ç©ºé—´å›¾å½¢" class="sidebar-link">ç©ºé—´å›¾å½¢</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/./dailyRecord/OpenLayers.html#geometryol-geom-geometry-å‡ ä½•" class="sidebar-link">geometryol/geom/Geometryï¼ˆå‡ ä½•ï¼‰</a></li><li class="sidebar-sub-header"><a href="/./dailyRecord/OpenLayers.html#ol-feature-è¦ç´ " class="sidebar-link">ol/Featureï¼ˆè¦ç´ ï¼‰</a></li><li class="sidebar-sub-header"><a href="/./dailyRecord/OpenLayers.html#ol-style-style-æ ·å¼" class="sidebar-link">ol/style/Styleï¼ˆæ ·å¼ï¼‰</a></li><li class="sidebar-sub-header"><a href="/./dailyRecord/OpenLayers.html#ol-layer-vector-çŸ¢é‡å›¾å±‚" class="sidebar-link">ol/layer/Vectorï¼ˆçŸ¢é‡å›¾å±‚ï¼‰</a></li><li class="sidebar-sub-header"><a href="/./dailyRecord/OpenLayers.html#ol-interaction-draw-ç»˜åˆ¶" class="sidebar-link">ol/interaction/Drawï¼ˆç»˜åˆ¶ï¼‰</a></li></ul></li><li class="sidebar-sub-header"><a href="/./dailyRecord/OpenLayers.html#å…³äºæŸ¥è¯¢æœåŠ¡" class="sidebar-link">å…³äºæŸ¥è¯¢æœåŠ¡</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/./dailyRecord/OpenLayers.html#arcgisæœåŠ¡" class="sidebar-link">arcgisæœåŠ¡</a></li><li class="sidebar-sub-header"><a href="/./dailyRecord/OpenLayers.html#è¶…å›¾æœåŠ¡" class="sidebar-link">è¶…å›¾æœåŠ¡</a></li></ul></li></ul></li><li><a href="/./dailyRecord/OLSourceCode1.html" class="sidebar-link">OpenLayers æºç åˆ†æ(ä¸Šç¯‡)</a></li><li><a href="/./dailyRecord/OLSourceCode2.html" class="sidebar-link">OpenLayers æºç åˆ†æ(ä¸‹ç¯‡)</a></li><li><a href="/./dailyRecord/ArcgisAPI.html" class="sidebar-link">Arcgis API</a></li><li><a href="/./dailyRecord/GISsystem.html" class="sidebar-link">GIS ä½“ç³»ä»‹ç»</a></li><li><a href="/./dailyRecord/SuperMapWebGL.html" class="sidebar-link">SuperMap iClient 3D for WebGL</a></li><li><a href="/./dailyRecord/SuperMapIserver.html" class="sidebar-link">SuperMap Iserver</a></li><li><a href="/./dailyRecord/SuperMap3DStudy.html" class="sidebar-link">ä¸‰ç»´WebGISå­¦ä¹ ç¬”è®°</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="openlayers-åŸºç¡€"><a href="#openlayers-åŸºç¡€" class="header-anchor">#</a> OpenLayers åŸºç¡€</h1> <h2 id="åœ°å›¾"><a href="#åœ°å›¾" class="header-anchor">#</a> åœ°å›¾</h2> <h3 id="ol-map-åœ°å›¾"><a href="#ol-map-åœ°å›¾" class="header-anchor">#</a> ol/Mapï¼ˆåœ°å›¾ï¼‰</h3> <p>åœ°å›¾å¯¹è±¡ï¼Œä½œä¸ºGISåº”ç”¨æœ€åŸºæœ¬çš„ä¸œè¥¿ï¼Œç”¨äºè£…è½½layerã€‚</p> <p>åŸºæœ¬å®ä¾‹åŒ–å‚æ•°ï¼š</p> <table><thead><tr><th>å‚æ•°å</th> <th>Type</th> <th>ç®€ä»‹</th></tr></thead> <tbody><tr><td>layers</td> <td>ol/layer</td> <td>å›¾å±‚ã€‚ å¦‚æœæœªå®šä¹‰ï¼Œåˆ™å°†æ¸²æŸ“æ²¡æœ‰å›¾å±‚çš„åœ°å›¾ã€‚ å›¾å±‚æ˜¯æŒ‰æä¾›çš„é¡ºåºæ¸²æŸ“çš„ï¼Œå› æ­¤ä¾‹å¦‚è¦ä½¿æŸå›¾å±‚å‡ºç°åœ¨çš„é¡¶éƒ¨ï¼Œåˆ™å®ƒå¿…é¡»ä½äºå›¾å±‚ç»„æœ€åã€‚</td></tr> <tr><td>target</td> <td>HTMLElement æˆ– string</td> <td>åœ°å›¾çš„å®¹å™¨ï¼ŒDOMå…ƒç´ æœ¬èº«æˆ–DOMå…ƒç´ IDã€‚ å¦‚æœåœ¨æ„é€ æ—¶æœªæŒ‡å®šï¼Œåˆ™å¿…é¡»è°ƒç”¨setTargetå‡½æ•°æ‰èƒ½æ¸²æŸ“åœ°å›¾ã€‚</td></tr> <tr><td>view</td> <td>ol/View</td> <td>åœ°å›¾çš„è§†å›¾ã€‚ä¹Ÿå¯ä»¥é€šè¿‡setViewå‡½æ•°è®¾ç½®</td></tr></tbody></table> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">overlays</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span>tipsOverlay<span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token literal-property property">layers</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>basemapLayers<span class="token punctuation">,</span>
  <span class="token literal-property property">target</span><span class="token operator">:</span> mapNode<span class="token punctuation">,</span>
  <span class="token literal-property property">view</span><span class="token operator">:</span> mapView
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="ol-view-è§†å›¾"><a href="#ol-view-è§†å›¾" class="header-anchor">#</a> ol/Viewï¼ˆè§†å›¾ï¼‰</h3> <p>Viewå¯¹è±¡ä»£è¡¨åœ°å›¾çš„ç®€å•2Dè§†å›¾ã€‚</p> <h4 id="è§†å›¾çŠ¶æ€"><a href="#è§†å›¾çŠ¶æ€" class="header-anchor">#</a> è§†å›¾çŠ¶æ€</h4> <p>è§†å›¾ç”±ä¸‰ç§å‚æ•°ç¡®å®šï¼šcenterï¼Œresolutionï¼Œå’Œrotationã€‚
æ¯ä¸ªçŠ¶æ€å…·æœ‰ç›¸åº”çš„è·å–å’Œè®¾ç½®ï¼Œä¾‹å¦‚ getCenterå’ŒsetCenterç”¨äºcenterçŠ¶æ€ã€‚</p> <h4 id="çº¦æŸæ¡ä»¶"><a href="#çº¦æŸæ¡ä»¶" class="header-anchor">#</a> çº¦æŸæ¡ä»¶</h4> <p>setCenterï¼ŒsetResolutionå¹¶setRotationå¯ä»¥ç”¨æ¥æ”¹å˜è§†å›¾çš„çŠ¶æ€ã€‚å¹¶ä¸”Viewå¯¹è±¡å¯ä»¥å¯¹è¿™ä¸‰ä¸ªå‚æ•°è¿›è¡Œçº¦æŸã€‚</p> <ul><li>åˆ†è¾¨ç‡çº¦æŸï¼š
ç”±resolutionsï¼ŒmaxResolutionï¼ŒmaxZoomå’ŒzoomFactorå››ä¸ªå‚æ•°å†³å®šã€‚</li> <li>æ—‹è½¬çº¦æŸï¼š
ç”±enableRotationå’ŒconstrainRotationå‚æ•°å†³å®šã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œæ—‹è½¬æ˜¯å…è®¸çš„ï¼Œå¹¶ä¸”åœ¨æ¥è¿‘æ°´å¹³æ–¹å‘æ—¶å…¶å€¼ä¼šå›ºå®šä¸ºé›¶ã€‚</li> <li>ä¸­å¿ƒçº¦æŸï¼š
ç”±extentå‚æ•°å†³å®šã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œè§†å›¾ä¸­å¿ƒå®Œå…¨ä¸å—çº¦æŸã€‚</li></ul> <h3 id="ol-proj-projection-åæ ‡ç³»"><a href="#ol-proj-projection-åæ ‡ç³»" class="header-anchor">#</a> ol/proj/Projectionï¼ˆåæ ‡ç³»ï¼‰</h3> <p>æŠ•å½±å®šä¹‰ç±»ã€‚å¯¹äºéepsg3857ï¼Œ4326çš„åæ ‡ç³»çš„åœ°å›¾æœåŠ¡ï¼Œæ˜¯éœ€è¦åˆ©ç”¨proj4æ’ä»¶å®šä¹‰æŠ•å½±ï¼Œå¹¶æ³¨å†Œï¼Œæ‰èƒ½æ­£å¸¸åŠ è½½ã€‚</p> <p>å•ä½ï¼š</p> <blockquote><p>ç±³ï¼š&quot;m&quot;æˆ–&quot;meter&quot;
åº¦ï¼š&quot;degrees&quot;æˆ–&quot;degree&quot;</p></blockquote> <p><strong>è¸©å‘è®°å½•ï¼š
Projectionä¸€å®šè¦å¸¦ä¸Šå•ä½ã€‚å¦åˆ™é»˜è®¤ä¸ºâ€œåº¦â€ã€‚å¦‚æœåæ ‡ç³»çš„å•ä½ä¸æ˜¯åº¦çš„è¯å°±æƒ¨äº†ï¼Œåé¢åŠ è½½åˆ‡ç‰‡è®¡ç®—å‡ºæ¥çš„åˆ‡ç‰‡è¡Œåˆ—å·ä¼šå·®çš„åä¸‡å…«åƒé‡Œï¼Œè€Œä¸”å¾ˆéš¾æƒ³åˆ°æ˜¯å› ä¸ºProjectionå•ä½å¯¼è‡´çš„ï¼Œç›¸å½“éš¾å®šä½é—®é¢˜ã€‚</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> proj4 <span class="token keyword">from</span> <span class="token string">'proj4'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Projection <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;ol/proj&quot;</span><span class="token punctuation">;</span>

proj4<span class="token punctuation">.</span><span class="token function">defs</span><span class="token punctuation">(</span><span class="token string">&quot;EPSG:4525&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;+proj=tmerc +lat_0=0 +lon_0=111 +k=1 +x_0=37500000 +y_0=0 +ellps=GRS80 +units=m +no_defs&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">register</span><span class="token punctuation">(</span>proj4<span class="token punctuation">)</span><span class="token punctuation">;</span>
projection <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Projection</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">code</span><span class="token operator">:</span> <span class="token string">&quot;EPSG:4525&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">extent</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">37528668.9634</span><span class="token punctuation">,</span> <span class="token number">2376156.7121</span><span class="token punctuation">,</span> <span class="token number">37641094.4958</span><span class="token punctuation">,</span> <span class="token number">2510788.1806</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token literal-property property">units</span><span class="token operator">:</span> <span class="token string">&quot;m&quot;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> mapView <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">View</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  projection<span class="token punctuation">,</span>
  <span class="token operator">...</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>æœ‰å…³å„ç§æŠ•å½±çš„å‚æ•°å®šä¹‰ï¼Œå¯å‚è€ƒ</p> <p><a href="https://epsg.io/" target="_blank" rel="noopener noreferrer">epsg<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h3 id="ol-overlay-åœ°å›¾å¼¹çª—"><a href="#ol-overlay-åœ°å›¾å¼¹çª—" class="header-anchor">#</a> ol/Overlayï¼ˆåœ°å›¾å¼¹çª—ï¼‰</h3> <p>è¦åœ¨åœ°å›¾ä¸Šæ˜¾ç¤ºå¹¶é™„åŠ åˆ°å•ä¸ªåœ°å›¾ä½ç½®çš„å…ƒç´ ã€‚é€šè¿‡ç»‘å®šåˆ°åœ°ç†åæ ‡ï¼Œè·Ÿéšåœ°å›¾çš„ç§»åŠ¨è€Œç§»åŠ¨ã€‚</p> <p>åŸºæœ¬å®ä¾‹åŒ–å‚æ•°ï¼š</p> <table><thead><tr><th>å‚æ•°å</th> <th>Type</th> <th>ç®€ä»‹</th></tr></thead> <tbody><tr><td>id</td> <td>string</td> <td>å›¾å±‚ID</td></tr> <tr><td>element</td> <td>HTMLElement</td> <td>DOMå…ƒç´ </td></tr> <tr><td>offset</td> <td>Array</td> <td>åç§»</td></tr> <tr><td>positioning</td> <td>ol/OverlayPositioning</td> <td>å®šä¹‰å åŠ å±‚ç›¸å¯¹äºå…¶positionå±æ€§çš„å®é™…å®šä½æ–¹å¼</td></tr></tbody></table> <p>ä½¿ç”¨ç¤ºä¾‹</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> Overlay <span class="token keyword">from</span> <span class="token string">'ol/Overlay'</span><span class="token punctuation">;</span>

<span class="token function">createOverLay</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>TipElement<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>TipElement<span class="token punctuation">.</span>parentNode<span class="token punctuation">.</span><span class="token function">removeChild</span><span class="token punctuation">(</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>TipElement
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>TipElement <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">&quot;div&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>TipElement<span class="token punctuation">.</span>className <span class="token operator">=</span> <span class="token string">&quot;ol-tooltip ol-tooltip-measure&quot;</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>TipElement<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token string">&quot;MyOverlay&quot;</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>TipOverlay <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Overlay</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token string">&quot;measureOverlay&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">element</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>TipElement<span class="token punctuation">,</span>
    <span class="token literal-property property">offset</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token literal-property property">positioning</span><span class="token operator">:</span> <span class="token string">&quot;bottom-center&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>TipOverlay<span class="token punctuation">.</span><span class="token function">setPosition</span><span class="token punctuation">(</span>tooltipCoord<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>map<span class="token punctuation">.</span><span class="token function">addOverlay</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>TipOverlay<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="å›¾å±‚"><a href="#å›¾å±‚" class="header-anchor">#</a> å›¾å±‚</h2> <h3 id="ol-layer-image"><a href="#ol-layer-image" class="header-anchor">#</a> ol/layer/Image</h3> <p>åŠ¨æ€æœåŠ¡å›¾å±‚ç±»</p> <p>åŸºæœ¬å®ä¾‹åŒ–å‚æ•°ï¼š</p> <table><thead><tr><th>å‚æ•°å</th> <th>Type</th> <th>ç®€ä»‹</th></tr></thead> <tbody><tr><td>opacity</td> <td>number</td> <td>é€æ˜åº¦ï¼ˆé»˜è®¤æ˜¯1ï¼‰</td></tr> <tr><td>visible</td> <td>boolean</td> <td>æ˜¯å¦å¯è§</td></tr> <tr><td>extent</td> <td>ol/extent</td> <td>å›¾å±‚æ¸²æŸ“çš„è¾¹ç•ŒèŒƒå›´</td></tr> <tr><td>zIndex</td> <td>number</td> <td>å›¾å±‚çš„å åŠ é¡ºåº</td></tr> <tr><td>map</td> <td></td> <td>mapå¯¹è±¡</td></tr> <tr><td>source</td> <td>ol/source/Image</td> <td>imageå›¾å±‚èµ„æºç±»</td></tr></tbody></table> <h3 id="ol-layer-tile"><a href="#ol-layer-tile" class="header-anchor">#</a> ol/layer/Tile</h3> <p>åˆ‡ç‰‡æœåŠ¡å›¾å±‚ç±»</p> <p>åŸºæœ¬å®ä¾‹åŒ–å‚æ•°ï¼š</p> <table><thead><tr><th>å‚æ•°å</th> <th>Type</th> <th>ç®€ä»‹</th></tr></thead> <tbody><tr><td>opacity</td> <td>number</td> <td>é€æ˜åº¦ï¼ˆé»˜è®¤æ˜¯1ï¼‰</td></tr> <tr><td>visible</td> <td>boolean</td> <td>æ˜¯å¦å¯è§</td></tr> <tr><td>extent</td> <td>ol/extent</td> <td>å›¾å±‚æ¸²æŸ“çš„è¾¹ç•ŒèŒƒå›´</td></tr> <tr><td>zIndex</td> <td>number</td> <td>å›¾å±‚çš„å åŠ é¡ºåº</td></tr> <tr><td>map</td> <td></td> <td>mapå¯¹è±¡</td></tr> <tr><td>source</td> <td>ol/source/Tile</td> <td>Tileå›¾å±‚èµ„æºç±»</td></tr></tbody></table> <h3 id="ol-source-xyz"><a href="#ol-source-xyz" class="header-anchor">#</a> ol/source/XYZ</h3> <p>åŠ è½½åˆ‡ç‰‡æœåŠ¡çš„åˆ‡ç‰‡èµ„æºç±»</p> <p>åŸºæœ¬å®ä¾‹åŒ–å‚æ•°ï¼š</p> <table><thead><tr><th>å‚æ•°å</th> <th>Type</th> <th>ç®€ä»‹</th></tr></thead> <tbody><tr><td>crossOrigin</td> <td>string</td> <td>åŠ è½½å›¾åƒçš„crossOriginå±æ€§</td></tr> <tr><td>projection</td> <td>ol/proj</td> <td>åæ ‡ç³»</td></tr> <tr><td>opaque</td> <td>boolean</td> <td>å›¾å±‚æ˜¯å¦ä¸é€æ˜ï¼ˆé»˜è®¤æ˜¯ï¼‰</td></tr> <tr><td>url</td> <td>string</td> <td>arcgis æœåŠ¡åœ°å€</td></tr> <tr><td>tileGrid</td> <td>ol/tilegrid/TileGrid</td> <td>åˆ‡ç‰‡ç»„</td></tr> <tr><td>url</td> <td>string</td> <td>åˆ‡ç‰‡æœåŠ¡åœ°å€ + &quot;/tile/{z}/{y}/{x}&quot;</td></tr> <tr><td>tileSize</td> <td>number</td> <td>åˆ‡ç‰‡å¤§å°ï¼Œæ²¡æœ‰çš„è¯è¯»å–tileGridçš„</td></tr></tbody></table> <h3 id="ol-tilegrid-tilegrid"><a href="#ol-tilegrid-tilegrid" class="header-anchor">#</a> ol/tilegrid/TileGrid</h3> <p>ç”¨äºè®¾ç½®åœ°å›¾æœåŠ¡çš„åˆ‡ç‰‡ç»„</p> <p>åŸºæœ¬å®ä¾‹åŒ–å‚æ•°ï¼š</p> <table><thead><tr><th>å‚æ•°å</th> <th>Type</th> <th>ç®€ä»‹</th></tr></thead> <tbody><tr><td>tileSize</td> <td>number</td> <td>åˆ‡ç‰‡å¤§å°</td></tr> <tr><td>resolutions</td> <td>Array</td> <td>Resolutionä»£è¡¨å½“å‰åœ°å›¾èŒƒå›´å†…ï¼Œ1åƒç´ ä»£è¡¨å¤šå°‘åœ°å›¾å•ä½ï¼Œåœ°å›¾å•ä½å–å†³äºç©ºé—´å‚è€ƒã€‚</td></tr> <tr><td>origin</td> <td>Array</td> <td>åˆ‡ç‰‡åŸç‚¹</td></tr> <tr><td>extent</td> <td>ol/extent</td> <td>è¯·æ±‚åˆ‡ç‰‡çš„è¾¹ç•ŒèŒƒå›´</td></tr></tbody></table> <h3 id="arcgisåŠ¨æ€å›¾å±‚"><a href="#arcgisåŠ¨æ€å›¾å±‚" class="header-anchor">#</a> arcgisåŠ¨æ€å›¾å±‚</h3> <p>openlayersæä¾›äº†åŠ è½½arcgis mapserverçš„åŠ¨æ€å›¾å±‚ç±»ï¼ˆol/source/ImageArcGISRestï¼‰ã€‚</p> <p><strong>ä½¿ç”¨åœºæ™¯ï¼šåœ¨openlayersä¸­ä»¥åŠ¨æ€æœåŠ¡å›¾å±‚çš„æ–¹å¼åŠ è½½ Arcgis Serverçš„MapServerã€‚å¯¹æ ‡arcgis apiä¸­çš„mapImageLayer</strong></p> <p>åŸºæœ¬å®ä¾‹åŒ–å‚æ•°ï¼š</p> <table><thead><tr><th>å‚æ•°å</th> <th>Type</th> <th>ç®€ä»‹</th></tr></thead> <tbody><tr><td>crossOrigin</td> <td>string</td> <td>åŠ è½½å›¾åƒçš„crossOriginå±æ€§</td></tr> <tr><td>params</td> <td>Object</td> <td>ArcGIS Restå‚æ•°(åé¢ä¼šä¸¾ä¾‹è¯´æ˜)</td></tr> <tr><td>projection</td> <td>ol/proj</td> <td>åæ ‡ç³»ï¼Œé»˜è®¤è·ŸéšmapView</td></tr> <tr><td>url</td> <td>string</td> <td>arcgis æœåŠ¡åœ°å€</td></tr></tbody></table> <p>ä½¿ç”¨ç¤ºä¾‹ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> ImageLayer <span class="token keyword">from</span> <span class="token string">&quot;ol/layer/Image&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> ImageArcGISRest <span class="token keyword">from</span> <span class="token string">&quot;ol/source/ImageArcGISRest&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> arcgisImageSource <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ImageArcGISRest</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">params</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// åªæ˜¾ç¤ºä¸‹æ ‡ä¸º0çš„å›¾å±‚</span>
    <span class="token constant">LAYERS</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">show:0</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    <span class="token comment">// å¯ä¸ºç©ºï¼ŒåŠ¨æ€å›¾å±‚æœåŠ¡ç«¯æ¸²æŸ“ç­‰å‚æ•°çš„å¡«å†™ä½ç½®</span>
    <span class="token literal-property property">dynamicLayers</span><span class="token operator">:</span> <span class="token string">&quot;...&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">url</span><span class="token operator">:</span> serviceInfo<span class="token punctuation">.</span>url<span class="token punctuation">,</span>
  <span class="token literal-property property">crossOrigin</span><span class="token operator">:</span> <span class="token string">&quot;anonymous&quot;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> layer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ImageLayer</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">id</span><span class="token operator">:</span> id<span class="token punctuation">,</span>
  <span class="token literal-property property">visible</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token literal-property property">source</span><span class="token operator">:</span> arcgisImageSource
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

map<span class="token punctuation">.</span><span class="token function">addLayer</span><span class="token punctuation">(</span>layer<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="arcgisåŠ¨æ€å›¾å±‚-ç±»åˆ‡ç‰‡"><a href="#arcgisåŠ¨æ€å›¾å±‚-ç±»åˆ‡ç‰‡" class="header-anchor">#</a> arcgisåŠ¨æ€å›¾å±‚ï¼ˆç±»åˆ‡ç‰‡ï¼‰</h3> <p>ç”±äºåŠ¨æ€å›¾å±‚çš„åŸç†ï¼Œå¯¹äºæ•°æ®è¾ƒå¤šçš„æœåŠ¡ï¼Œserverå‡ºå›¾çš„æ—¶é—´ä¼šä¸å°½äººæ„ã€‚æ‰€ä»¥å‡ºç°äº†è¿™ç§åŠ è½½æ–¹å¼ã€‚</p> <p><strong>Q:
ä½•ä¸ºç±»åˆ‡ç‰‡å›¾å±‚ï¼Ÿ</strong></p> <p><strong>A:
ä¸€èˆ¬æ¥è¯´åŠ¨æ€å›¾å±‚éƒ½æ˜¯å°†å½“å‰è§†å›¾èŒƒå›´ä¼ ç»™serverï¼Œç”±serveræ¸²æŸ“ä¸€å¼ å›¾ç‰‡æ˜¾ç¤ºå‡ºæ¥ã€‚
ç±»åˆ‡ç‰‡æ˜¯å°†å½“å‰è§†å›¾èŒƒå›´æŒ‰ç…§ä¸€å®šçš„å®½é«˜åšåˆ†å‰²ï¼Œåˆ†å‰²åå°†åˆ†å—èŒƒå›´é€šè¿‡å¹¶å‘è¯·æ±‚serveræ¸²æŸ“åˆ†å‰²åŒºåŸŸçš„å›¾ç‰‡ï¼Œæœ€åå°†è¿™äº›å›¾ç‰‡æŒ‰åˆ‡ç‰‡å›¾å±‚çš„åŸç†æ‹¼æ¥å›æ¥ã€‚</strong></p> <p><strong>Q:
æœ‰ä½•ä¼˜ç‚¹ï¼Ÿ</strong></p> <p><strong>A:
æ¯”å¦‚å½“å‰è§†å›¾æ•°æ®è¾ƒå¤šï¼Œserveræ¸²æŸ“ä¸€å¼ å›¾éœ€è¦å››ç§’ã€‚ç†è®ºä¸Šå°†è¿™ä¸ªèŒƒå›´åˆ†æˆ4ä»½å»å¹¶å‘çš„è¯·æ±‚ï¼Œæ¸²æŸ“æ—¶é—´ä¼šç¼©çŸ­ä¸º1ç§’ï¼Œä»¥æ­¤ç±»æ¨åˆ†æˆ8ä»½ä¼šåˆ°0.5ç§’ã€‚å½“ç„¶è¿˜ä¼šå—åˆ°æµè§ˆå™¨æœ€å¤§å¹¶å‘è¯·æ±‚æ•°çš„é™åˆ¶ï¼Œä½†æ˜¯ç†è®ºä¸Šæ•ˆæœæ˜¯ä¼šå¥½äºä¸€èˆ¬çš„åŠ¨æ€å›¾å±‚</strong></p> <p>åŸºæœ¬å®ä¾‹åŒ–å‚æ•°ï¼š</p> <table><thead><tr><th>å‚æ•°å</th> <th>Type</th> <th>ç®€ä»‹</th></tr></thead> <tbody><tr><td>crossOrigin</td> <td>string</td> <td>åŠ è½½å›¾åƒçš„crossOriginå±æ€§</td></tr> <tr><td>params</td> <td>Object</td> <td>ArcGIS Restå‚æ•°(åé¢ä¼šä¸¾ä¾‹è¯´æ˜)</td></tr> <tr><td>projection</td> <td>ol/proj</td> <td>åæ ‡ç³»ï¼Œé»˜è®¤è·ŸéšmapView</td></tr> <tr><td>url</td> <td>string</td> <td>arcgis æœåŠ¡åœ°å€</td></tr> <tr><td>tileGrid</td> <td>ol/tilegrid/TileGrid</td> <td>åˆ‡ç‰‡ç»„ã€‚å†³å®šåŠ¨æ€å›¾å±‚å¦‚ä½•åˆ‡å‰²ï¼ˆé»˜è®¤æ ¹æ®mapViewçš„Projectionçš„èŒƒå›´è¿›è¡Œåˆ‡å‰²ï¼‰</td></tr></tbody></table> <p>ä½¿ç”¨ç¤ºä¾‹ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> TileLayer <span class="token keyword">from</span> <span class="token string">&quot;ol/layer/Tile&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> TileArcGISRest <span class="token keyword">from</span> <span class="token string">&quot;ol/source/TileArcGISRest&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> arcgisImageSource <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TileArcGISRest</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">params</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// åªæ˜¾ç¤ºä¸‹æ ‡ä¸º0çš„å›¾å±‚</span>
    <span class="token constant">LAYERS</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">show:0</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    <span class="token comment">// å¯ä¸ºç©ºï¼ŒåŠ¨æ€å›¾å±‚æœåŠ¡ç«¯æ¸²æŸ“ç­‰å‚æ•°çš„å¡«å†™ä½ç½®</span>
    <span class="token literal-property property">dynamicLayers</span><span class="token operator">:</span> <span class="token string">&quot;...&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">url</span><span class="token operator">:</span> serviceInfo<span class="token punctuation">.</span>url<span class="token punctuation">,</span>
  <span class="token literal-property property">crossOrigin</span><span class="token operator">:</span> <span class="token string">&quot;anonymous&quot;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> layer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TileLayer</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">id</span><span class="token operator">:</span> id<span class="token punctuation">,</span>
  <span class="token literal-property property">visible</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token literal-property property">source</span><span class="token operator">:</span> arcgisImageSource
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

map<span class="token punctuation">.</span><span class="token function">addLayer</span><span class="token punctuation">(</span>layer<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="arcgisåˆ‡ç‰‡å›¾å±‚"><a href="#arcgisåˆ‡ç‰‡å›¾å±‚" class="header-anchor">#</a> arcgisåˆ‡ç‰‡å›¾å±‚</h3> <p>openlayersæä¾›äº†åŠ è½½åˆ‡ç‰‡æœåŠ¡å›¾å±‚ç±»ï¼ˆol/source/XYZï¼‰</p> <p>ä½¿ç”¨åœºæ™¯ï¼šåœ¨openlayersä¸­ä»¥åˆ‡ç‰‡æœåŠ¡å›¾å±‚çš„æ–¹å¼åŠ è½½ Arcgis Serverçš„MapServerã€‚å¯¹æ ‡arcgis apiä¸­çš„tileLayer</p> <p>ä½¿ç”¨ç¤ºä¾‹ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> TileLayer <span class="token keyword">from</span> <span class="token string">&quot;ol/layer/Tile&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token constant">XYZ</span> <span class="token keyword">from</span> <span class="token string">&quot;ol/source/XYZ&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> TileGrid <span class="token keyword">from</span> <span class="token string">&quot;ol/tilegrid/TileGrid&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> tileGrid <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TileGrid</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">tileSize</span><span class="token operator">:</span> <span class="token number">256</span><span class="token punctuation">,</span>
  <span class="token literal-property property">origin</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token operator">*</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token literal-property property">resolutions</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token operator">*</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// ç“¦ç‰‡æ•°æ®æº</span>
<span class="token keyword">let</span> arcgisXYZTileSource <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XYZ</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">tileGrid</span><span class="token operator">:</span> tileGrid<span class="token punctuation">,</span>
  <span class="token literal-property property">projection</span><span class="token operator">:</span> <span class="token string">&quot;EPSG:4525&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">url</span><span class="token operator">:</span> mapServerUrl <span class="token operator">+</span> <span class="token string">&quot;/tile/{z}/{y}/{x}&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">crossOrigin</span><span class="token operator">:</span> <span class="token string">&quot;anonymous&quot;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> layer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TileLayer</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">id</span><span class="token operator">:</span> id<span class="token punctuation">,</span>
  <span class="token literal-property property">className</span><span class="token operator">:</span> id<span class="token punctuation">,</span>
  <span class="token literal-property property">visible</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token literal-property property">source</span><span class="token operator">:</span> arcgisXYZTileSource
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

map<span class="token punctuation">.</span><span class="token function">addLayer</span><span class="token punctuation">(</span>layer<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="supermapåŠ¨æ€å›¾å±‚"><a href="#supermapåŠ¨æ€å›¾å±‚" class="header-anchor">#</a> supermapåŠ¨æ€å›¾å±‚</h3> <p>openlayersæœ¬èº«æ˜¯ä¸æ”¯æŒç›´æ¥åŠ è½½è¶…å›¾æœåŠ¡çš„ã€‚ä½†æ˜¯è¶…å›¾æä¾›äº†å›¾å±‚ç±»ï¼Œä½¿å¾—openlayersä¸Šå¯ä»¥åŠ è½½SuperMap iServer Image å›¾å±‚æºã€‚</p> <p>å·¥å…·ç±»å…·ä½“ä¿¡æ¯å‚è€ƒï¼š</p> <p><a href="https://github.com/SuperMap/iClient-JavaScript/blob/master/src/openlayers/mapping/ImageSuperMapRest.js" target="_blank" rel="noopener noreferrer">ImageSuperMapRest<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>åŸºæœ¬å®ä¾‹åŒ–å‚æ•°ï¼š</p> <table><thead><tr><th>å‚æ•°å</th> <th>Type</th> <th>ç®€ä»‹</th></tr></thead> <tbody><tr><td>url</td> <td>string</td> <td>åœ°å›¾æœåŠ¡åœ°å€</td></tr> <tr><td>layersID</td> <td>string</td> <td>æŒ‡å®šå›¾å±‚æ˜¾éš</td></tr> <tr><td>prjCoordSys</td> <td>object</td> <td>åæ ‡ç³»</td></tr></tbody></table> <p>ç‰¹åˆ«è¯´æ˜ï¼š
layersIDè¿™ä¸ªå±æ€§æ˜¯ç”¨æ¥æ§åˆ¶å­å›¾å±‚æ˜¾éšçš„ï¼Œå…·ä½“ä»‹ç»å¦‚ä¸‹ï¼š</p> <blockquote><p>å½“å‰åœ°å›¾å›¾å±‚IDçš„å®šä¹‰è§„åˆ™å¦‚ä¸‹ï¼š</p> <ol><li>å„çº§å›¾å±‚æŒ‰ç…§å›¾å±‚é¡ºåºè‡ªä¸Šè€Œä¸‹ä»0å¼€å§‹ç¼–å·ï¼›</li> <li>å†’å·ï¼ˆ:ï¼‰å‰ä¸ºåœ°å›¾ï¼›</li> <li>è‹±æ–‡å¥å·ï¼ˆ.ï¼‰è¡¨ç¤ºå…¶ä»–å„çº§å›¾å±‚é—´çš„ä»å±å…³ç³»ï¼›</li> <li>è‹±æ–‡é€—å·ï¼ˆ,ï¼‰è¡¨ç¤ºå›¾å±‚é—´çš„åˆ†éš”ã€‚</li></ol> <p>ä¾‹å¦‚ï¼š</p> <ol><li>[0:0,1,2.0]è¡¨ç¤ºåœ°å›¾0ä¸‹é¢çš„å›¾å±‚ï¼š0ã€1åŠå…¶ä¸‹å±æ‰€æœ‰å­å›¾å±‚ï¼Œå’Œ2ä¸‹çš„å­å›¾å±‚0ï¼›</li> <li>[1:1.2,2]è¡¨ç¤ºåœ°å›¾1ä¸‹é¢çš„å›¾å±‚ï¼š1ä¸‹çš„å­å›¾å±‚2ï¼Œå’Œå›¾å±‚2åŠå…¶ä¸‹å±æ‰€æœ‰å­å›¾å±‚ï¼›</li> <li>ä¸¤ä¸ªç¤ºä¾‹åˆå¹¶åœ¨ä¸€èµ·åˆ™æ˜¯ï¼š[0:0,1,2.0,1:1.2,2]
æ­¤å¤–ï¼Œ[0,1,2,3]è¡¨ç¤ºåœ°å›¾0ä¸‹é¢çš„å›¾å±‚0ã€1ã€2ã€3åŠæ‰€æœ‰å­å›¾å±‚ï¼Œ[0:,1:,2:]è¡¨ç¤ºåœ°å›¾0ã€1ã€2åŠå…¶æ‰€æœ‰å­å›¾å±‚ã€‚</li> <li>å½“æˆ‘ä»¬åˆå§‹åŒ–å›¾å±‚ä¹‹åè¿˜æƒ³æ”¹å˜å›¾å±‚æ˜¾ç¤ºæ—¶å¯ä»¥ç›´æ¥å¦‚ä¸‹è¿›è¡Œè®¾ç½®ï¼š layer.layersID = â€œ[0:0,1,7,11]â€</li></ol></blockquote> <p>ä½¿ç”¨ç¤ºä¾‹ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> TileLayer <span class="token keyword">from</span> <span class="token string">&quot;ol/layer/Tile&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> ImageSuperMapRest <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;***/ImageSuperMapRest&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> supermapImageSource <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ImageSuperMapRest</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">url</span><span class="token operator">:</span> serviceUrl<span class="token punctuation">,</span>
  <span class="token literal-property property">prjCoordSys</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">epsgCode</span><span class="token operator">:</span> <span class="token string">&quot;4525&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">crossOrigin</span><span class="token operator">:</span> <span class="token string">&quot;anonymous&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">layersID</span><span class="token operator">:</span> <span class="token string">&quot;[0:0,1,2]&quot;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> layer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TileLayer</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">id</span><span class="token operator">:</span> id<span class="token punctuation">,</span>
  <span class="token literal-property property">className</span><span class="token operator">:</span> id<span class="token punctuation">,</span>
  <span class="token literal-property property">visible</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token literal-property property">source</span><span class="token operator">:</span> supermapImageSource
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

map<span class="token punctuation">.</span><span class="token function">addLayer</span><span class="token punctuation">(</span>layer<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="supermapåŠ¨æ€å›¾å±‚-ç±»åˆ‡ç‰‡"><a href="#supermapåŠ¨æ€å›¾å±‚-ç±»åˆ‡ç‰‡" class="header-anchor">#</a> supermapåŠ¨æ€å›¾å±‚ï¼ˆç±»åˆ‡ç‰‡ï¼‰</h3> <p>openlayersæœ¬èº«æ˜¯ä¸æ”¯æŒç›´æ¥åŠ è½½è¶…å›¾æœåŠ¡çš„ã€‚ä½†æ˜¯è¶…å›¾æä¾›äº†å›¾å±‚ç±»ï¼Œä½¿å¾—openlayersä¸Šå¯ä»¥åŠ è½½SuperMap iServer TileImage å›¾å±‚æºã€‚</p> <p>å·¥å…·ç±»å…·ä½“ä¿¡æ¯å‚è€ƒï¼š</p> <p><a href="https://github.com/SuperMap/iClient-JavaScript/blob/master/src/openlayers/mapping/TileSuperMapRest.js" target="_blank" rel="noopener noreferrer">TileSuperMapRest<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>åŸºæœ¬å®ä¾‹åŒ–å‚æ•°ï¼š</p> <table><thead><tr><th>å‚æ•°å</th> <th>Type</th> <th>ç®€ä»‹</th></tr></thead> <tbody><tr><td>url</td> <td>string</td> <td>åœ°å›¾æœåŠ¡åœ°å€</td></tr> <tr><td>layersID</td> <td>string</td> <td>æŒ‡å®šå›¾å±‚æ˜¾éš</td></tr> <tr><td>prjCoordSys</td> <td>object</td> <td>åæ ‡ç³»</td></tr> <tr><td>tileGrid</td> <td>ol/tilegrid/TileGrid</td> <td>åˆ‡ç‰‡ç»„ã€‚</td></tr></tbody></table> <p>ä½¿ç”¨ç¤ºä¾‹ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> TileLayer <span class="token keyword">from</span> <span class="token string">&quot;ol/layer/Tile&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> TileGrid <span class="token keyword">from</span> <span class="token string">&quot;ol/tilegrid/TileGrid&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> ImageSuperMapRest <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;***/TileSuperMapRest&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> tileGrid <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TileGrid</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">tileSize</span><span class="token operator">:</span> <span class="token number">256</span><span class="token punctuation">,</span>
  <span class="token literal-property property">origin</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token operator">*</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token literal-property property">resolutions</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token operator">*</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> supermapImageSource <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ImageSuperMapRest</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">url</span><span class="token operator">:</span> serviceUrl<span class="token punctuation">,</span>
  <span class="token literal-property property">tileGrid</span><span class="token operator">:</span> tileGrid<span class="token punctuation">,</span>
  <span class="token literal-property property">prjCoordSys</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">epsgCode</span><span class="token operator">:</span> <span class="token string">&quot;4525&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">crossOrigin</span><span class="token operator">:</span> <span class="token string">&quot;anonymous&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">layersID</span><span class="token operator">:</span> <span class="token string">&quot;[0:0,1,2]&quot;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> layer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TileLayer</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">id</span><span class="token operator">:</span> id<span class="token punctuation">,</span>
  <span class="token literal-property property">className</span><span class="token operator">:</span> id<span class="token punctuation">,</span>
  <span class="token literal-property property">visible</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token literal-property property">source</span><span class="token operator">:</span> supermapImageSource
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

map<span class="token punctuation">.</span><span class="token function">addLayer</span><span class="token punctuation">(</span>layer<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="supermapåˆ‡ç‰‡å›¾å±‚"><a href="#supermapåˆ‡ç‰‡å›¾å±‚" class="header-anchor">#</a> supermapåˆ‡ç‰‡å›¾å±‚</h3> <p>ç¨åè¡¥å……</p> <h2 id="ç©ºé—´å›¾å½¢"><a href="#ç©ºé—´å›¾å½¢" class="header-anchor">#</a> ç©ºé—´å›¾å½¢</h2> <h3 id="geometryol-geom-geometry-å‡ ä½•"><a href="#geometryol-geom-geometry-å‡ ä½•" class="header-anchor">#</a> geometryol/geom/Geometryï¼ˆå‡ ä½•ï¼‰</h3> <p>å‡ ä½•å¯¹è±¡çš„åŸºç±»ã€‚ æ­¤ç±»æ²¡æœ‰æ„é€ å‡½æ•°ï¼Œä¸èƒ½è¢«å®ä¾‹åŒ–ã€‚</p> <p>å¯¹æ ‡arcgis apiä¸­çš„ <code>esri/geometry/Geometry</code></p> <p>è¦æ„é€ å‡ ä½•ä½“ï¼Œå…·ä½“è¯·å‚è§å®˜æ–¹æ–‡æ¡£ï¼Œè¿™é‡Œä¸å†èµ˜è¿°ï¼š</p> <blockquote><p>ç‚¹ç±»å‹
<a href="https://openlayers.org/en/latest/apidoc/module-ol_geom_Point-Point.html" target="_blank" rel="noopener noreferrer">å•ç‚¹<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <a href="https://openlayers.org/en/latest/apidoc/module-ol_geom_MultiPoint-MultiPoint.html" target="_blank" rel="noopener noreferrer">å¤šç‚¹<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></blockquote> <blockquote><p>çº¿ç±»å‹
<a href="https://openlayers.org/en/latest/apidoc/module-ol_geom_LineString-LineString.html" target="_blank" rel="noopener noreferrer">æŠ˜çº¿<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <a href="https://openlayers.org/en/latest/apidoc/module-ol_geom_MultiLineString-MultiLineString.html" target="_blank" rel="noopener noreferrer">è‡ªç”±çº¿<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></blockquote> <blockquote><p>é¢ç±»å‹
<a href="https://openlayers.org/en/latest/apidoc/module-ol_geom_Polygon-Polygon.html" target="_blank" rel="noopener noreferrer">å¤šè¾¹å½¢<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <a href="https://openlayers.org/en/latest/apidoc/module-ol_geom_Circle-Circle.html" target="_blank" rel="noopener noreferrer">åœ†<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></blockquote> <h3 id="ol-feature-è¦ç´ "><a href="#ol-feature-è¦ç´ " class="header-anchor">#</a> ol/Featureï¼ˆè¦ç´ ï¼‰</h3> <p>å‡ ä½•è¦ç´ ã€‚åŒ…å«geometryï¼Œattributesä»¥åŠæ ·å¼styleã€‚
å¯¹æ ‡arcgis apiçš„ Graphicã€‚</p> <p>å¯ä»¥ä½¿ç”¨setStyleåˆ†åˆ«è®¾ç½®æ ·å¼ã€‚ å¦åˆ™ï¼Œå®ƒä»¬å°†ä½¿ç”¨å…¶çŸ¢é‡å±‚çš„æ ·å¼ã€‚</p> <p>å®ä¾‹åŒ–å‚æ•°ï¼šå¯ä»¥ç›´æ¥ä¼ é€’Geometryå¯¹è±¡ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªå¯¹è±¡ã€‚å¦‚æœæ˜¯å¯¹è±¡ï¼Œåˆ™å¯¹è±¡å¿…é¡»åŒ…å«ä¸€ä¸ªgeometryçš„å±æ€§ä½œä¸ºFeatureçš„å‡ ä½•å›¾å½¢ã€‚</p> <p>ä½¿ç”¨ç¤ºä¾‹ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Point<span class="token punctuation">,</span> LineString<span class="token punctuation">,</span> Polygon <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;ol/geom&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> Feature <span class="token keyword">from</span> <span class="token string">&quot;ol/Feature&quot;</span><span class="token punctuation">;</span>

<span class="token comment">// ä¸€ä¸ªçŸ©å½¢</span>
Geo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Polygon</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
  <span class="token punctuation">[</span>
    <span class="token punctuation">[</span>xmin<span class="token punctuation">,</span> ymin<span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span>xmin<span class="token punctuation">,</span> ymax<span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span>xmax<span class="token punctuation">,</span> ymax<span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span>xmax<span class="token punctuation">,</span> ymin<span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span>xmin<span class="token punctuation">,</span> ymin<span class="token punctuation">]</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> tempFeature <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Feature</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">attributes</span><span class="token operator">:</span> Attributes<span class="token punctuation">,</span>
  <span class="token literal-property property">geometry</span><span class="token operator">:</span> Geo<span class="token punctuation">,</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'My Polygon'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

feature<span class="token punctuation">.</span><span class="token function">setStyle</span><span class="token punctuation">(</span>symbol<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="ol-style-style-æ ·å¼"><a href="#ol-style-style-æ ·å¼" class="header-anchor">#</a> ol/style/Styleï¼ˆæ ·å¼ï¼‰</h3> <p>å‡ ä½•å›¾å½¢çš„æ ·å¼ç±»ã€‚</p> <p>åŸºæœ¬å®ä¾‹åŒ–å‚æ•°ï¼š</p> <table><thead><tr><th>å‚æ•°å</th> <th>Type</th> <th>ç®€ä»‹</th></tr></thead> <tbody><tr><td>fill</td> <td>ol/style/Fill</td> <td>å¡«å……æ ·å¼</td></tr> <tr><td>image</td> <td>ol/style/Image</td> <td>å›¾ç‰‡æ ·å¼</td></tr> <tr><td>renderer</td> <td>RenderFunction</td> <td>æ¸²æŸ“å™¨ï¼Œè®¾ç½®åfillï¼Œstroke å’Œ imageéƒ½ä¼šå¿½ç•¥</td></tr> <tr><td>stroke</td> <td>ol/style/Stroke</td> <td>å¤–è¾¹çº¿çš„æ ·å¼</td></tr> <tr><td>text</td> <td>ol/style/Text</td> <td>æ–‡æœ¬æ ·å¼</td></tr></tbody></table> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Style<span class="token punctuation">,</span> Circle<span class="token punctuation">,</span> Fill<span class="token punctuation">,</span> Stroke <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;ol/style&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> symbol <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Style</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">fill</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Fill</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">&quot;rgba(255, 0, 0, 0)&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token literal-property property">image</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Circle</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">fill</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Fill</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">&quot;rgba(255, 0, 0, 1)&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token literal-property property">radius</span><span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span>
    <span class="token literal-property property">stroke</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Stroke</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">&quot;rgba(255, 0, 0, 0)&quot;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">1</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token literal-property property">stroke</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Stroke</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">&quot;rgba(255, 0, 0, 1)&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">2</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="ol-layer-vector-çŸ¢é‡å›¾å±‚"><a href="#ol-layer-vector-çŸ¢é‡å›¾å±‚" class="header-anchor">#</a> ol/layer/Vectorï¼ˆçŸ¢é‡å›¾å±‚ï¼‰</h3> <p>å‘ˆç°ç»™å®¢æˆ·ç«¯çš„çŸ¢é‡æ•°æ®ã€‚
å¯¹æ ‡arcgis apiçš„<code>esri/layers/GraphicsLayer</code></p> <p>åŸºæœ¬å®ä¾‹åŒ–å‚æ•°ï¼š</p> <table><thead><tr><th>å‚æ•°å</th> <th>Type</th> <th>ç®€ä»‹</th></tr></thead> <tbody><tr><td>opacity</td> <td>number</td> <td>é€æ˜åº¦ï¼ˆé»˜è®¤æ˜¯1ï¼‰</td></tr> <tr><td>visible</td> <td>boolean</td> <td>æ˜¯å¦å¯è§</td></tr> <tr><td>extent</td> <td>ol/extent</td> <td>å›¾å±‚æ¸²æŸ“çš„è¾¹ç•ŒèŒƒå›´</td></tr> <tr><td>zIndex</td> <td>number</td> <td>å›¾å±‚çš„å åŠ é¡ºåº</td></tr> <tr><td>source</td> <td>ol/source/Vector</td> <td>çŸ¢é‡æ•°æ®</td></tr></tbody></table> <p>ä½¿ç”¨ç¤ºä¾‹ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Vector <span class="token keyword">as</span> VectorLayer <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;ol/layer&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Vector <span class="token keyword">as</span> VectorSource <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;ol/source&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> vectorSource <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">VectorSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> vectorLayer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">VectorLayer</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">id</span><span class="token operator">:</span> layerID<span class="token punctuation">,</span>
  <span class="token literal-property property">className</span><span class="token operator">:</span> layerID<span class="token punctuation">,</span>
  <span class="token literal-property property">source</span><span class="token operator">:</span> vectorSource
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

map<span class="token punctuation">.</span><span class="token function">addLayer</span><span class="token punctuation">(</span>vectorLayer<span class="token punctuation">)</span><span class="token punctuation">;</span>

vectorLayer<span class="token punctuation">.</span><span class="token function">getSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addFeature</span><span class="token punctuation">(</span>feature<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="ol-interaction-draw-ç»˜åˆ¶"><a href="#ol-interaction-draw-ç»˜åˆ¶" class="header-anchor">#</a> ol/interaction/Drawï¼ˆç»˜åˆ¶ï¼‰</h3> <p>ç»˜åˆ¶è¦ç´ å‡ ä½•çš„äº¤äº’å·¥å…·ã€‚</p> <p>åŸºæœ¬å®ä¾‹åŒ–å‚æ•°ï¼š</p> <table><thead><tr><th>å‚æ•°å</th> <th>Type</th> <th>ç®€ä»‹</th></tr></thead> <tbody><tr><td>type</td> <td>ol/geom/GeometryType</td> <td>ç”¨æ­¤å®ä¾‹ç»˜åˆ¶çš„å‡ ä½•ç±»å‹</td></tr> <tr><td>features</td> <td>ol/Feature</td> <td>ç»˜åˆ¶è¦ç´ çš„ç›®æ ‡é›†åˆ</td></tr> <tr><td>source</td> <td>ol/source/Vector</td> <td>ç»˜åˆ¶è¦ç´ çš„ç›®æ ‡æº</td></tr> <tr><td>style</td> <td>ol/style/Style</td> <td>è‰å›¾æ ·å¼</td></tr> <tr><td>freehand</td> <td>boolean</td> <td>æ˜¯å¦è‡ªç”±ç»˜åˆ¶ï¼Œé»˜è®¤å¦</td></tr></tbody></table> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token constant">DRAWTYPE</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token constant">POINT</span><span class="token operator">:</span> <span class="token string">&quot;Point&quot;</span><span class="token punctuation">,</span> <span class="token comment">// ç‚¹</span>
  <span class="token constant">LINE_STRING</span><span class="token operator">:</span> <span class="token string">&quot;LineString&quot;</span><span class="token punctuation">,</span> <span class="token comment">// çº¿</span>
  <span class="token constant">POLYGON</span><span class="token operator">:</span> <span class="token string">&quot;Polygon&quot;</span><span class="token punctuation">,</span> <span class="token comment">// é¢</span>
  <span class="token constant">CIRCLE</span><span class="token operator">:</span> <span class="token string">&quot;Circle&quot;</span><span class="token punctuation">,</span> <span class="token comment">// åœ†,è§„åˆ™å¤šè¾¹å½¢</span>
  <span class="token constant">BOX</span><span class="token operator">:</span> <span class="token string">&quot;Box&quot;</span><span class="token punctuation">,</span> <span class="token comment">// çŸ©å½¢</span>
  <span class="token constant">NONE</span><span class="token operator">:</span> <span class="token string">&quot;None&quot;</span> <span class="token comment">// å…³é—­draw</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> drawInteraction <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Draw</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token constant">DRAWTYPE</span><span class="token punctuation">.</span><span class="token constant">POLYGON</span><span class="token punctuation">,</span>
  <span class="token literal-property property">freehand</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
map<span class="token punctuation">.</span><span class="token function">addInteraction</span><span class="token punctuation">(</span>drawInteraction<span class="token punctuation">)</span><span class="token punctuation">;</span>

drawInteraction<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;drawend&quot;</span><span class="token punctuation">,</span> <span class="token parameter">DrawEvent</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  map<span class="token punctuation">.</span><span class="token function">removeInteraction</span><span class="token punctuation">(</span>drawInteraction<span class="token punctuation">)</span><span class="token punctuation">;</span>
  vectorLayer<span class="token punctuation">.</span><span class="token function">getSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">let</span> feature <span class="token operator">=</span> DrawEvent<span class="token punctuation">.</span>feature<span class="token punctuation">;</span>
  vectorLayer<span class="token punctuation">.</span><span class="token function">getSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addFeature</span><span class="token punctuation">(</span>feature<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="å…³äºæŸ¥è¯¢æœåŠ¡"><a href="#å…³äºæŸ¥è¯¢æœåŠ¡" class="header-anchor">#</a> å…³äºæŸ¥è¯¢æœåŠ¡</h2> <p>åœ¨openlayersä¸­åŠ è½½arcgisæˆ–è¶…å›¾çš„æœåŠ¡ï¼Œå¯¹æœåŠ¡è¿›è¡ŒæŸ¥è¯¢çš„æ–¹å¼ï¼Œé™¤äº†ä½¿ç”¨å¯¹åº”å‚å•†æä¾›çš„APIï¼Œä¹Ÿå¯ä»¥è‡ªå·±æ ¹æ®æœåŠ¡æä¾›çš„æŸ¥è¯¢æ¥å£ï¼Œè¡¥å……å‚æ•°è¿›è¡ŒæŸ¥è¯¢è¯·æ±‚ã€‚</p> <p>è¿™é‡Œä¸ä»‹ç»æŸ¥è¯¢çš„å‚æ•°ï¼Œåªä»‹ç»å¦‚ä½•å°†ä¸¤å®¶çš„æœåŠ¡æŸ¥è¯¢å‡ºæ¥çš„è¦ç´ æ¸²æŸ“åˆ°openlayersçš„åœ°å›¾ä¸Šã€‚</p> <h3 id="arcgisæœåŠ¡"><a href="#arcgisæœåŠ¡" class="header-anchor">#</a> arcgisæœåŠ¡</h3> <p>å°†arcgisæœåŠ¡æŸ¥è¯¢åˆ°çš„è¦ç´ è½¬åŒ–ä¸ºopenlayersçš„è¦ç´ ã€‚</p> <p>å…³äºæŸ¥è¯¢çš„å‚æ•°å¯ä»¥å‚è€ƒarcgis api å®˜ç½‘</p> <p><a href="https://developers.arcgis.com/javascript/latest/api-reference/esri-tasks-support-Query.html" target="_blank" rel="noopener noreferrer">Query<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>ä½¿ç”¨æ¡ˆä¾‹ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> http <span class="token keyword">from</span> <span class="token string">&quot;../Utils/http&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Point<span class="token punctuation">,</span> LineString<span class="token punctuation">,</span> Polygon <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;ol/geom&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> Feature <span class="token keyword">from</span> <span class="token string">&quot;ol/Feature&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> esriGeometryType <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">esriGeometryPoint</span><span class="token operator">:</span> <span class="token string">&quot;esriGeometryPoint&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">esriGeometryMultipoint</span><span class="token operator">:</span> <span class="token string">&quot;esriGeometryMultipoint&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">esriGeometryPolyline</span><span class="token operator">:</span> <span class="token string">&quot;esriGeometryPolyline&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">esriGeometryPolygon</span><span class="token operator">:</span> <span class="token string">&quot;esriGeometryPolygon&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">esriGeometryEnvelope</span><span class="token operator">:</span> <span class="token string">&quot;esriGeometryEnvelope&quot;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

http<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>url<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>layerID<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/query</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>param<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">response</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token function">dealWithEsriResult</span><span class="token punctuation">(</span>response<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">resolve</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">error</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">reject</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// å¤„ç†arcgisæŸ¥è¯¢ç»“æœ</span>
<span class="token function">dealWithEsriResult</span><span class="token punctuation">(</span><span class="token parameter">result</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  result<span class="token punctuation">.</span>features<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">feature</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> tempGeo <span class="token operator">=</span> <span class="token function">esriGeometry2OLGeo</span><span class="token punctuation">(</span>feature<span class="token punctuation">.</span>geometry<span class="token punctuation">,</span> result<span class="token punctuation">.</span>geometryType<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> tempFeature <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Feature</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">geometry</span><span class="token operator">:</span> tempGeo <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    tempFeature<span class="token punctuation">.</span>attributes <span class="token operator">=</span> feature<span class="token punctuation">.</span>attributes<span class="token punctuation">;</span>
    tempResult<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>tempFeature<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span>result<span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">features</span><span class="token operator">:</span> tempResult <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> result<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
 * @description å°†esri geometryå¯¹è±¡è½¬æ¢æˆopenlayer geometryå¯¹è±¡
 * @param {String} geometryType
 */</span>
<span class="token keyword">const</span> <span class="token function-variable function">esriGeometry2OLGeo</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">esriGeometry<span class="token punctuation">,</span> geometryType</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> olgeo <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  <span class="token keyword">switch</span> <span class="token punctuation">(</span>geometryType<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">case</span> esriGeometryType<span class="token punctuation">.</span>esriGeometryPoint<span class="token operator">:</span>
      olgeo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Point</span><span class="token punctuation">(</span><span class="token punctuation">[</span>esriGeometry<span class="token punctuation">.</span>x<span class="token punctuation">,</span> esriGeometry<span class="token punctuation">.</span>y<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> esriGeometryType<span class="token punctuation">.</span>esriGeometryMultipoint<span class="token operator">:</span>
      <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> esriGeometryType<span class="token punctuation">.</span>esriGeometryPolyline<span class="token operator">:</span>
      olgeo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LineString</span><span class="token punctuation">(</span>esriGeometry<span class="token punctuation">.</span>paths<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> esriGeometryType<span class="token punctuation">.</span>esriGeometryPolygon<span class="token operator">:</span>
      olgeo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Polygon</span><span class="token punctuation">(</span>esriGeometry<span class="token punctuation">.</span>rings<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> esriGeometryType<span class="token punctuation">.</span>esriGeometryEnvelope<span class="token operator">:</span>
      olgeo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Polygon</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
        <span class="token punctuation">[</span>
          <span class="token punctuation">[</span>esriGeometry<span class="token punctuation">.</span>xmin<span class="token punctuation">,</span> esriGeometry<span class="token punctuation">.</span>ymin<span class="token punctuation">]</span><span class="token punctuation">,</span>
          <span class="token punctuation">[</span>esriGeometry<span class="token punctuation">.</span>xmin<span class="token punctuation">,</span> esriGeometry<span class="token punctuation">.</span>ymax<span class="token punctuation">]</span><span class="token punctuation">,</span>
          <span class="token punctuation">[</span>esriGeometry<span class="token punctuation">.</span>xmax<span class="token punctuation">,</span> esriGeometry<span class="token punctuation">.</span>ymax<span class="token punctuation">]</span><span class="token punctuation">,</span>
          <span class="token punctuation">[</span>esriGeometry<span class="token punctuation">.</span>xmax<span class="token punctuation">,</span> esriGeometry<span class="token punctuation">.</span>ymin<span class="token punctuation">]</span><span class="token punctuation">,</span>
          <span class="token punctuation">[</span>esriGeometry<span class="token punctuation">.</span>xmin<span class="token punctuation">,</span> esriGeometry<span class="token punctuation">.</span>ymin<span class="token punctuation">]</span>
        <span class="token punctuation">]</span>
      <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">break</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> olgeo<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="è¶…å›¾æœåŠ¡"><a href="#è¶…å›¾æœåŠ¡" class="header-anchor">#</a> è¶…å›¾æœåŠ¡</h3> <p>å°†è¶…å›¾æœåŠ¡æŸ¥è¯¢åˆ°çš„è¦ç´ è½¬åŒ–ä¸ºopenlayersçš„è¦ç´ ã€‚</p> <p>å…³äºæŸ¥è¯¢çš„å‚æ•°å¯ä»¥å‚è€ƒæˆ‘ä¹‹å‰å†™çš„ä½¿ç”¨è¶…å›¾APIæŸ¥è¯¢çš„ç¬”è®°</p> <p><a href="http://support.supermap.com.cn:8090/iserver/help/html/zh/mergedProjects/SuperMapiServerRESTAPI/root/data/featureResults/featureResults.htm" target="_blank" rel="noopener noreferrer">è¶…å›¾æŸ¥è¯¢API<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>ä½¿ç”¨æ¡ˆä¾‹ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> http <span class="token keyword">from</span> <span class="token string">&quot;../Utils/http&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Point<span class="token punctuation">,</span> LineString<span class="token punctuation">,</span> Polygon <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;ol/geom&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> Feature <span class="token keyword">from</span> <span class="token string">&quot;ol/Feature&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> smGeometryType <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">smGeometryPoint</span><span class="token operator">:</span> <span class="token string">&quot;POINT&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">smGeometryPolyline</span><span class="token operator">:</span> <span class="token string">&quot;LINE&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">smGeometryPolygon</span><span class="token operator">:</span> <span class="token string">&quot;REGION&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">smGeometryEnvelope</span><span class="token operator">:</span> <span class="token string">&quot;RECTANGLE&quot;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

http<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>url<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/rest/data/featureResults.json?returnContent=true</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>param<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">response</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token function">dealWithSuperMapResult</span><span class="token punctuation">(</span>response<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">resolve</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">error</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">reject</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// å¤„ç†è¶…å›¾æŸ¥è¯¢ç»“æœ</span>
<span class="token function">dealWithSuperMapResult</span><span class="token punctuation">(</span><span class="token parameter">result</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">let</span> tempResult <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  result<span class="token punctuation">.</span>features<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">feature</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> tempGeo <span class="token operator">=</span> <span class="token function">smGeometry2OLGeo</span><span class="token punctuation">(</span>feature<span class="token punctuation">.</span>geometry<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> tempAttributes <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    feature<span class="token punctuation">.</span>fieldNames<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">fieldName<span class="token punctuation">,</span> index</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      tempAttributes<span class="token punctuation">[</span>fieldName<span class="token punctuation">]</span> <span class="token operator">=</span> feature<span class="token punctuation">.</span>fieldValues<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> tempFeature <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Feature</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">attributes</span><span class="token operator">:</span> tempAttributes<span class="token punctuation">,</span>
      <span class="token literal-property property">geometry</span><span class="token operator">:</span> tempGeo
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    tempFeature<span class="token punctuation">.</span>attributes <span class="token operator">=</span> tempAttributes<span class="token punctuation">;</span>
    tempResult<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>tempFeature<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span>result<span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">features</span><span class="token operator">:</span> tempResult <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> result<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
 * @description å°†supermap geometryå¯¹è±¡è½¬ openlayer geometryå¯¹è±¡
 */</span>
<span class="token keyword">const</span> <span class="token function-variable function">smGeometry2OLGeo</span> <span class="token operator">=</span> <span class="token parameter">smGeometry</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> olgeo <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
    pointArr2 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> startIndex <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  smGeometry<span class="token punctuation">.</span>parts<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">part</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> tempPoints <span class="token operator">=</span> smGeometry<span class="token punctuation">.</span>points<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span>startIndex<span class="token punctuation">,</span> startIndex <span class="token operator">+</span> part<span class="token punctuation">)</span><span class="token punctuation">;</span>
    startIndex <span class="token operator">+=</span> part<span class="token punctuation">;</span>
    <span class="token keyword">let</span> pointArr1 <span class="token operator">=</span> tempPoints<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token punctuation">[</span>item<span class="token punctuation">.</span>x<span class="token punctuation">,</span> item<span class="token punctuation">.</span>y<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    pointArr2<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>pointArr1<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">switch</span> <span class="token punctuation">(</span>smGeometry<span class="token punctuation">.</span>type<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">case</span> smGeometryType<span class="token punctuation">.</span>smGeometryPoint<span class="token operator">:</span>
      olgeo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Point</span><span class="token punctuation">(</span><span class="token punctuation">[</span>smGeometry<span class="token punctuation">.</span>points<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>x<span class="token punctuation">,</span> smGeometry<span class="token punctuation">.</span>points<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>y<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> smGeometryType<span class="token punctuation">.</span>smGeometryPolyline<span class="token operator">:</span>
      olgeo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LineString</span><span class="token punctuation">(</span>pointArr2<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> smGeometryType<span class="token punctuation">.</span>smGeometryPolygon<span class="token operator">:</span>
      olgeo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Polygon</span><span class="token punctuation">(</span>pointArr2<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> smGeometryType<span class="token punctuation">.</span>smGeometryEnvelope<span class="token operator">:</span>
      olgeo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Polygon</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
        <span class="token punctuation">[</span>
          <span class="token punctuation">[</span>smGeometry<span class="token punctuation">.</span>xmin<span class="token punctuation">,</span> smGeometry<span class="token punctuation">.</span>ymin<span class="token punctuation">]</span><span class="token punctuation">,</span>
          <span class="token punctuation">[</span>smGeometry<span class="token punctuation">.</span>xmin<span class="token punctuation">,</span> smGeometry<span class="token punctuation">.</span>ymax<span class="token punctuation">]</span><span class="token punctuation">,</span>
          <span class="token punctuation">[</span>smGeometry<span class="token punctuation">.</span>xmax<span class="token punctuation">,</span> smGeometry<span class="token punctuation">.</span>ymax<span class="token punctuation">]</span><span class="token punctuation">,</span>
          <span class="token punctuation">[</span>smGeometry<span class="token punctuation">.</span>xmax<span class="token punctuation">,</span> smGeometry<span class="token punctuation">.</span>ymin<span class="token punctuation">]</span><span class="token punctuation">,</span>
          <span class="token punctuation">[</span>smGeometry<span class="token punctuation">.</span>xmin<span class="token punctuation">,</span> smGeometry<span class="token punctuation">.</span>ymin<span class="token punctuation">]</span>
        <span class="token punctuation">]</span>
      <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">break</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> olgeo<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><div class="to-top"><svg t="1547627942927" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1955" xmlns:xlink="http://www.w3.org/1999/xlink" width="64" height="64" class="icon"><path d="M752.736 431.063C757.159 140.575 520.41 8.97 504.518 0.41V0l-0.45 0.205-0.41-0.205v0.41c-15.934 8.56-252.723 140.165-248.259 430.653-48.21 31.457-98.713 87.368-90.685 184.074 8.028 96.666 101.007 160.768 136.601 157.287 35.595-3.482 25.232-30.31 25.232-30.31l12.206-50.095s52.47 80.569 69.304 80.528c15.114-1.23 87-0.123 95.6 0h0.82c8.602-0.123 80.486-1.23 95.6 0 16.794 0 69.305-80.528 69.305-80.528l12.165 50.094s-10.322 26.83 25.272 30.31c35.595 3.482 128.574-60.62 136.602-157.286 8.028-96.665-42.475-152.617-90.685-184.074z m-248.669-4.26c-6.758-0.123-94.781-3.359-102.891-107.192 2.95-98.714 95.97-107.438 102.891-107.93 6.964 0.492 99.943 9.216 102.892 107.93-8.11 103.833-96.174 107.07-102.892 107.192z m-52.019 500.531c0 11.838-9.42 21.382-21.012 21.382a21.217 21.217 0 0 1-21.054-21.34V821.74c0-11.797 9.421-21.382 21.054-21.382 11.591 0 21.012 9.585 21.012 21.382v105.635z m77.333 57.222a21.504 21.504 0 0 1-21.34 21.626 21.504 21.504 0 0 1-21.34-21.626V827.474c0-11.96 9.543-21.668 21.299-21.668 11.796 0 21.38 9.708 21.38 21.668v157.082z m71.147-82.043c0 11.796-9.42 21.34-21.053 21.34a21.217 21.217 0 0 1-21.013-21.34v-75.367c0-11.755 9.421-21.299 21.013-21.299 11.632 0 21.053 9.544 21.053 21.3v75.366z" fill="#3eaf7c" p-id="1956"></path></svg></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">1/20/2021, 9:43:15 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      â†
      <a href="/./dailyRecord/2020.html" class="prev">
        2020 é¡¹ç›®ç»éªŒæ€»ç»“
      </a></span> <span class="next"><a href="/./dailyRecord/OLSourceCode1.html">
        OpenLayers æºç åˆ†æ(ä¸Šç¯‡)
      </a>
      â†’
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="./assets/js/app.78793606.js" defer></script><script src="./assets/js/3.9a8cb714.js" defer></script><script src="./assets/js/37.64bf3a08.js" defer></script><script src="./assets/js/17.7a89769a.js" defer></script>
  </body>
</html>
