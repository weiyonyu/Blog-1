<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Arcgis API | Notebook</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="">
    <meta name="description" content="📝每天记录一点点">
    
    <link rel="preload" href="./assets/css/0.styles.81cbcbf8.css" as="style"><link rel="preload" href="./assets/js/app.78793606.js" as="script"><link rel="preload" href="./assets/js/3.9a8cb714.js" as="script"><link rel="preload" href="./assets/js/34.c6f368f7.js" as="script"><link rel="preload" href="./assets/js/17.7a89769a.js" as="script"><link rel="prefetch" href="./assets/js/10.3f7afedc.js"><link rel="prefetch" href="./assets/js/11.849f2ab3.js"><link rel="prefetch" href="./assets/js/12.f69c7e94.js"><link rel="prefetch" href="./assets/js/13.ab50e66a.js"><link rel="prefetch" href="./assets/js/14.4b2fce32.js"><link rel="prefetch" href="./assets/js/15.8b353502.js"><link rel="prefetch" href="./assets/js/16.3195875f.js"><link rel="prefetch" href="./assets/js/18.fcadf835.js"><link rel="prefetch" href="./assets/js/19.231d3618.js"><link rel="prefetch" href="./assets/js/2.56707d7e.js"><link rel="prefetch" href="./assets/js/20.a85f560c.js"><link rel="prefetch" href="./assets/js/21.24336449.js"><link rel="prefetch" href="./assets/js/22.73659552.js"><link rel="prefetch" href="./assets/js/23.a091243a.js"><link rel="prefetch" href="./assets/js/24.c8ba16f0.js"><link rel="prefetch" href="./assets/js/25.882bb768.js"><link rel="prefetch" href="./assets/js/26.f04079ce.js"><link rel="prefetch" href="./assets/js/27.3ccd410f.js"><link rel="prefetch" href="./assets/js/28.58938703.js"><link rel="prefetch" href="./assets/js/29.a0b3a5cc.js"><link rel="prefetch" href="./assets/js/30.054f5cc9.js"><link rel="prefetch" href="./assets/js/31.2a2497ca.js"><link rel="prefetch" href="./assets/js/32.2fec2015.js"><link rel="prefetch" href="./assets/js/33.1c38360d.js"><link rel="prefetch" href="./assets/js/35.eb21b972.js"><link rel="prefetch" href="./assets/js/36.d24643c3.js"><link rel="prefetch" href="./assets/js/37.64bf3a08.js"><link rel="prefetch" href="./assets/js/38.9456e466.js"><link rel="prefetch" href="./assets/js/39.d6639e8e.js"><link rel="prefetch" href="./assets/js/4.3e5912c4.js"><link rel="prefetch" href="./assets/js/40.0be61706.js"><link rel="prefetch" href="./assets/js/41.83d228f2.js"><link rel="prefetch" href="./assets/js/42.4a8c6e1b.js"><link rel="prefetch" href="./assets/js/43.ed4184d6.js"><link rel="prefetch" href="./assets/js/44.84f96688.js"><link rel="prefetch" href="./assets/js/45.99c1db7a.js"><link rel="prefetch" href="./assets/js/46.38462d37.js"><link rel="prefetch" href="./assets/js/47.18ad8970.js"><link rel="prefetch" href="./assets/js/5.07eb40e3.js"><link rel="prefetch" href="./assets/js/6.be2121ec.js"><link rel="prefetch" href="./assets/js/7.198c5ca7.js"><link rel="prefetch" href="./assets/js/8.0d657d1b.js"><link rel="prefetch" href="./assets/js/9.35e5878d.js">
    <link rel="stylesheet" href="./assets/css/0.styles.81cbcbf8.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/./" class="home-link router-link-active"><!----> <span class="site-name">Notebook</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/./dailyRecord/" class="nav-link router-link-active">
  📚学习总结
</a></div><div class="nav-item"><a href="/./bookmark/" class="nav-link">
  📌书签整理
</a></div><div class="nav-item"><a href="/./lint/" class="nav-link">
  ✔️编码规范&amp;协同开发
</a></div><div class="nav-item"><a href="http://shooterblog.site/Learn-JS-Demo/%E5%89%8D%E7%AB%AF%E7%9F%A5%E8%AF%86%E5%9B%BE%E8%B0%B1/index.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  📖知识脑图
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/./dailyRecord/" class="nav-link router-link-active">
  📚学习总结
</a></div><div class="nav-item"><a href="/./bookmark/" class="nav-link">
  📌书签整理
</a></div><div class="nav-item"><a href="/./lint/" class="nav-link">
  ✔️编码规范&amp;协同开发
</a></div><div class="nav-item"><a href="http://shooterblog.site/Learn-JS-Demo/%E5%89%8D%E7%AB%AF%E7%9F%A5%E8%AF%86%E5%9B%BE%E8%B0%B1/index.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  📖知识脑图
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>前端模块化和打包工具</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>前端异常监控</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Vue3原理</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Vue3源码</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>内功修炼</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>总结</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>GIS</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/./dailyRecord/OpenLayers.html" class="sidebar-link">OpenLayers 基础</a></li><li><a href="/./dailyRecord/OLSourceCode1.html" class="sidebar-link">OpenLayers 源码分析(上篇)</a></li><li><a href="/./dailyRecord/OLSourceCode2.html" class="sidebar-link">OpenLayers 源码分析(下篇)</a></li><li><a href="/./dailyRecord/ArcgisAPI.html" aria-current="page" class="active sidebar-link">Arcgis API</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/./dailyRecord/ArcgisAPI.html#arcgis-api-渲染" class="sidebar-link">Arcgis API 渲染</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/./dailyRecord/ArcgisAPI.html#simplerenderer-简单渲染" class="sidebar-link">SimpleRenderer（简单渲染）</a></li><li class="sidebar-sub-header"><a href="/./dailyRecord/ArcgisAPI.html#classbreaksrenderer-分级渲染" class="sidebar-link">ClassBreaksRenderer（分级渲染）</a></li><li class="sidebar-sub-header"><a href="/./dailyRecord/ArcgisAPI.html#uniquevaluerenderer-唯一值渲染" class="sidebar-link">UniqueValueRenderer（唯一值渲染）</a></li><li class="sidebar-sub-header"><a href="/./dailyRecord/ArcgisAPI.html#blendrenderer-混合渲染" class="sidebar-link">BlendRenderer（混合渲染）</a></li><li class="sidebar-sub-header"><a href="/./dailyRecord/ArcgisAPI.html#heatmaprenderer-热力图渲染" class="sidebar-link">HeatmapRenderer（热力图渲染）</a></li><li class="sidebar-sub-header"><a href="/./dailyRecord/ArcgisAPI.html#dotdensityrenderer-点密度渲染" class="sidebar-link">DotDensityRenderer（点密度渲染）</a></li><li class="sidebar-sub-header"><a href="/./dailyRecord/ArcgisAPI.html#scaledependentrenderer-不同比例尺不同渲染" class="sidebar-link">ScaleDependentRenderer（不同比例尺不同渲染）</a></li></ul></li><li class="sidebar-sub-header"><a href="/./dailyRecord/ArcgisAPI.html#arcgis-api-事件" class="sidebar-link">Arcgis API 事件</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/./dailyRecord/ArcgisAPI.html#简介" class="sidebar-link">简介</a></li><li class="sidebar-sub-header"><a href="/./dailyRecord/ArcgisAPI.html#_1-layer事件" class="sidebar-link">1. Layer事件</a></li><li class="sidebar-sub-header"><a href="/./dailyRecord/ArcgisAPI.html#_2-view事件" class="sidebar-link">2. View事件</a></li><li class="sidebar-sub-header"><a href="/./dailyRecord/ArcgisAPI.html#_3-api3-x与4-x的区别" class="sidebar-link">3. API3.x与4.x的区别</a></li><li class="sidebar-sub-header"><a href="/./dailyRecord/ArcgisAPI.html#_4-关于api-4-x的其他属性或事件" class="sidebar-link">4. 关于API 4.x的其他属性或事件</a></li></ul></li></ul></li><li><a href="/./dailyRecord/GISsystem.html" class="sidebar-link">GIS 体系介绍</a></li><li><a href="/./dailyRecord/SuperMapWebGL.html" class="sidebar-link">SuperMap iClient 3D for WebGL</a></li><li><a href="/./dailyRecord/SuperMapIserver.html" class="sidebar-link">SuperMap Iserver</a></li><li><a href="/./dailyRecord/SuperMap3DStudy.html" class="sidebar-link">三维WebGIS学习笔记</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="arcgis-api"><a href="#arcgis-api" class="header-anchor">#</a> Arcgis API</h1> <h2 id="arcgis-api-渲染"><a href="#arcgis-api-渲染" class="header-anchor">#</a> Arcgis API 渲染</h2> <h3 id="simplerenderer-简单渲染"><a href="#simplerenderer-简单渲染" class="header-anchor">#</a> SimpleRenderer（简单渲染）</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">require</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&quot;esri/renderers/SimpleRenderer&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">SimpleRenderer</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">/* code goes here */</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>使用场景:
给图层的要素统一设置固定的渲染方案</p> <p><strong>API 3.28</strong>
SimpleRenderer常用属性介绍：</p> <table><thead><tr><th>值</th> <th>类型</th> <th>描述</th></tr></thead> <tbody><tr><td>symbol</td> <td>Symbol</td> <td>渲染的符号</td></tr> <tr><td>visualVariables</td> <td>Object[]</td> <td>设置颜色，透明度，大小，和旋转度</td></tr></tbody></table> <p>使用案例：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> renderer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SimpleRenderer</span><span class="token punctuation">(</span>symbol<span class="token punctuation">)</span><span class="token punctuation">;</span>

renderer<span class="token punctuation">.</span><span class="token function">setVisualVariables</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">{</span>
    <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&quot;sizeInfo&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">field</span><span class="token operator">:</span> <span class="token string">&quot;field&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">minSize</span><span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span>
    <span class="token literal-property property">maxSize</span><span class="token operator">:</span> <span class="token number">50</span><span class="token punctuation">,</span>
    <span class="token literal-property property">minDataValue</span><span class="token operator">:</span> <span class="token number">50</span><span class="token punctuation">,</span>
    <span class="token literal-property property">maxDataValue</span><span class="token operator">:</span> <span class="token number">1000</span>
  <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>值得注意的是：
动态图层（ArcGISDynamicMapServiceLayer）中的LayerDrawingOptions属性设置visualVariables是无效的，会被忽略</p> <h3 id="classbreaksrenderer-分级渲染"><a href="#classbreaksrenderer-分级渲染" class="header-anchor">#</a> ClassBreaksRenderer（分级渲染）</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">require</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&quot;esri/renderers/ClassBreaksRenderer&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">ClassBreaksRenderer</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">/* code goes here */</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>使用场景:
根据给定的具体某个属性字段，根据该字段的值进行梯度分类，用不同符号的分类渲染。</p> <p><strong>API 3.28</strong>
ClassBreaksRenderer常用属性介绍：</p> <table><thead><tr><th>值</th> <th>类型</th> <th>描述</th></tr></thead> <tbody><tr><td>attributeField</td> <td>String</td> <td>渲染器匹配的属性字段</td></tr> <tr><td>defaultSymbol</td> <td>Symbol</td> <td>无法匹配值或中断时使用的默认符号。</td></tr> <tr><td>infos</td> <td>Object[]</td> <td>分级渲染配置</td></tr> <tr><td>isMaxInclusive</td> <td>Boolean</td> <td>分级渲染值上包含（默认true）</td></tr> <tr><td>normalizationType</td> <td>String</td> <td>指示如何规范化数据。</td></tr> <tr><td>normalizationTotal</td> <td>Number</td> <td>总值</td></tr> <tr><td>normalizationField</td> <td>String</td> <td>attributeField属性的字段会除这个字段</td></tr> <tr><td>visualVariables</td> <td>Object[]</td> <td>设置颜色，透明度，大小，和旋转度</td></tr></tbody></table> <p>使用案例：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> renderer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ClassBreaksRenderer</span><span class="token punctuation">(</span>defaultSymbol<span class="token punctuation">,</span> attributeField<span class="token punctuation">)</span><span class="token punctuation">;</span>

renderer<span class="token punctuation">.</span><span class="token function">addBreak</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">SimpleFillSymbol</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setColor</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Color</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">56</span><span class="token punctuation">,</span> <span class="token number">168</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
renderer<span class="token punctuation">.</span><span class="token function">addBreak</span><span class="token punctuation">(</span><span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">75</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">SimpleFillSymbol</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setColor</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Color</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">139</span><span class="token punctuation">,</span> <span class="token number">209</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 如果使用normalizationType</span>
<span class="token comment">// Break的值将会改变</span>

<span class="token comment">// normalizationTotal是所有要素attributeField字段的总和</span>
<span class="token comment">// 判断的Break的值将变成 attributeField/normalizationTotal*100</span>

<span class="token comment">// renderer.normalizationType = &quot;percent-of-total&quot;;</span>
<span class="token comment">// renderer.normalizationTotal = 1000;</span>

<span class="token comment">// attributeField将会除normalizationField字段</span>
<span class="token comment">// 判断的Break的值将变成 attributeField/normalizationField</span>
renderer<span class="token punctuation">.</span>normalizationType <span class="token operator">=</span> <span class="token string">&quot;field&quot;</span><span class="token punctuation">;</span>
renderer<span class="token punctuation">.</span>normalizationField <span class="token operator">=</span> <span class="token string">&quot;normalizationField&quot;</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="uniquevaluerenderer-唯一值渲染"><a href="#uniquevaluerenderer-唯一值渲染" class="header-anchor">#</a> UniqueValueRenderer（唯一值渲染）</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">require</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&quot;esri/renderers/UniqueValueRenderer&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">UniqueValueRenderer</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">/* code goes here */</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>使用场景:
根据给定的具体一个或多个属性字段，根据这些字段的值，对每一组唯一的值进行不同符号的分类渲染。</p> <p><strong>API 3.28</strong>
UniqueValueRenderer常用属性介绍：</p> <table><thead><tr><th>值</th> <th>类型</th> <th>描述</th></tr></thead> <tbody><tr><td>attributeField</td> <td>String</td> <td>渲染器匹配的属性字段</td></tr> <tr><td>defaultSymbol</td> <td>Symbol</td> <td>无法匹配值或中断时使用的默认符号。</td></tr> <tr><td>fieldDelimiter</td> <td>String</td> <td>如果指定了多个属性字段，值之间的分隔符</td></tr> <tr><td>infos</td> <td>Object[]</td> <td>唯一值渲染配置</td></tr> <tr><td>valueExpression</td> <td>String</td> <td>一个Arcade表达式，其值为字符串或数字。</td></tr> <tr><td>visualVariables</td> <td>Object[]</td> <td>设置颜色，透明度，大小，和旋转度</td></tr></tbody></table> <ul><li><a href="http://localhost/arcgis_js_v328_sdk/arcgis_js_api/sdk/jssamples/renderer_arcade.html" target="_blank" rel="noopener noreferrer">valueExpression使用介绍<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <p>使用案例：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> Options <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">outFields</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;attributeField1&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;attributeField2&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;attributeField3&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;attributeField4&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token keyword">var</span> uniqueValueRenderer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">UniqueValueRenderer</span><span class="token punctuation">(</span><span class="token function">createSymbol</span><span class="token punctuation">(</span><span class="token string">&quot;#d9d9d9&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">graphic</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">var</span> maxField <span class="token operator">=</span> <span class="token string">&quot;Other&quot;</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> max <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

  array<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>Options<span class="token punctuation">.</span>outFields<span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">field</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>graphic<span class="token punctuation">.</span>attributes<span class="token punctuation">[</span>field<span class="token punctuation">]</span> <span class="token operator">&gt;</span> max<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      maxField <span class="token operator">=</span> field<span class="token punctuation">;</span>
      max <span class="token operator">=</span> graphic<span class="token punctuation">.</span>attributes<span class="token punctuation">[</span>field<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> maxField<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">function</span> <span class="token function">createSymbol</span><span class="token punctuation">(</span><span class="token parameter">color</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">SimpleFillSymbol</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setColor</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Color</span><span class="token punctuation">(</span>color<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setOutline</span><span class="token punctuation">(</span>
      <span class="token keyword">new</span> <span class="token class-name">SimpleLineSymbol</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setColor</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Color</span><span class="token punctuation">(</span><span class="token string">&quot;#999999&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setWidth</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

  uniqueValueRenderer<span class="token punctuation">.</span><span class="token function">addValue</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token string">&quot;attributeField1&quot;</span><span class="token punctuation">,</span> <span class="token literal-property property">symbol</span><span class="token operator">:</span> <span class="token function">createSymbol</span><span class="token punctuation">(</span><span class="token string">&quot;#fd7f6f&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token literal-property property">label</span><span class="token operator">:</span> <span class="token string">&quot;Vegetables&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  uniqueValueRenderer<span class="token punctuation">.</span><span class="token function">addValue</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token string">&quot;attributeField2&quot;</span><span class="token punctuation">,</span> <span class="token literal-property property">symbol</span><span class="token operator">:</span> <span class="token function">createSymbol</span><span class="token punctuation">(</span><span class="token string">&quot;#b2e061&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token literal-property property">label</span><span class="token operator">:</span> <span class="token string">&quot;Cotton&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  uniqueValueRenderer<span class="token punctuation">.</span><span class="token function">addValue</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token string">&quot;attributeField3&quot;</span><span class="token punctuation">,</span> <span class="token literal-property property">symbol</span><span class="token operator">:</span> <span class="token function">createSymbol</span><span class="token punctuation">(</span><span class="token string">&quot;#bd7ebe&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token literal-property property">label</span><span class="token operator">:</span> <span class="token string">&quot;Wheat&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  uniqueValueRenderer<span class="token punctuation">.</span><span class="token function">addValue</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token string">&quot;attributeField4&quot;</span><span class="token punctuation">,</span> <span class="token literal-property property">symbol</span><span class="token operator">:</span> <span class="token function">createSymbol</span><span class="token punctuation">(</span><span class="token string">&quot;#7eb0d5&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token literal-property property">label</span><span class="token operator">:</span> <span class="token string">&quot;Soybeans&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="blendrenderer-混合渲染"><a href="#blendrenderer-混合渲染" class="header-anchor">#</a> BlendRenderer（混合渲染）</h3> <div class="language- extra-class"><pre class="language-text"><code>require([&quot;esri/renderers/BlendRenderer&quot;], function(BlendRenderer) { /* code goes here */ });
</code></pre></div><p>使用场景：
对于存在两个或以上具有相互竞争的属性字段，使用混合渲染可以给每个属性都分配有唯一的颜色，并根据属性字段值的大小计算出相应的透明度，最后进行颜色混合。所以，属性值越高，颜色越占优势。</p> <p><strong>API 3.28</strong>
BlendRenderer常用属性介绍：</p> <table><thead><tr><th>值</th> <th>类型</th> <th>描述</th></tr></thead> <tbody><tr><td>blendMode</td> <td>String</td> <td>决定颜色是如何混合在一起</td></tr> <tr><td>fields</td> <td>Object[]</td> <td>不同属性对应的颜色</td></tr> <tr><td>opacityStops</td> <td>Object[]</td> <td>值占比与透明度对应的设置</td></tr> <tr><td>normalizationField</td> <td>String</td> <td>几个竞争字段的总计值</td></tr> <tr><td>symbol</td> <td>Symbol</td> <td>对应的渲染符号</td></tr></tbody></table> <ul><li><a href="https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/globalCompositeOperation#Types" target="_blank" rel="noopener noreferrer">关于blendMode更多信息<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <p>案例：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> blendRendererOptions <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">blendMode</span><span class="token operator">:</span> <span class="token string">&quot;darken&quot;</span><span class="token punctuation">,</span> 
  <span class="token literal-property property">symbol</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">SimpleFillSymbol</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setOutline</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">SimpleLineSymbol</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setWidth</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token literal-property property">fields</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      <span class="token literal-property property">field</span><span class="token operator">:</span> <span class="token string">&quot;VALUE1&quot;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Color</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">230</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">field</span><span class="token operator">:</span> <span class="token string">&quot;VALUE2&quot;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Color</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">56</span><span class="token punctuation">,</span> <span class="token number">168</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token literal-property property">opacityStops</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
      <span class="token literal-property property">opacity</span><span class="token operator">:</span> <span class="token number">0</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
      <span class="token literal-property property">opacity</span><span class="token operator">:</span> <span class="token number">1</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token literal-property property">normalizationField</span><span class="token operator">:</span> <span class="token string">&quot;Total&quot;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

renderer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BlendRenderer</span><span class="token punctuation">(</span>blendRendererOptions<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>注：在4.11的API中暂无该渲染功能</p> <h3 id="heatmaprenderer-热力图渲染"><a href="#heatmaprenderer-热力图渲染" class="header-anchor">#</a> HeatmapRenderer（热力图渲染）</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">require</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&quot;esri/renderers/HeatmapRenderer&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">HeatmapRenderer</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">/* code goes here */</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>使用场景:
在点要素的渲染中，通过根据每个点的位置，以及其影响的范围，并且互相叠加，渲染成一幅热力图。</p> <p><strong>API 3.28</strong>
HeatmapRenderer常用属性介绍：</p> <table><thead><tr><th>值</th> <th>类型</th> <th>描述</th></tr></thead> <tbody><tr><td>blurRadius</td> <td>Number</td> <td>每个点的影像范围（以像素为单位）。</td></tr> <tr><td>colorStops</td> <td>Object[]</td> <td>按比例去描述渲染器的颜色渐变。</td></tr> <tr><td>colors</td> <td>String[]</td> <td>描述渲染器的颜色渐变。</td></tr> <tr><td>field</td> <td>String</td> <td>用于热力点加权的属性字段。</td></tr> <tr><td>maxPixelIntensity</td> <td>Number</td> <td>在色带中为最终颜色分配的像素强度值。</td></tr> <tr><td>minPixelIntensity</td> <td>Number</td> <td>在色带中为初始强度分配的像素强度值。（一般大于零）</td></tr></tbody></table> <p>使用案例：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> heatmapRenderer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HeatmapRenderer</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">field</span><span class="token operator">:</span> <span class="token string">&quot;Magnitude&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">blurRadius</span><span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">,</span>
  <span class="token literal-property property">colorStops</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span> <span class="token literal-property property">ratio</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">&quot;rgba(250, 0, 0, 0)&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> <span class="token literal-property property">ratio</span><span class="token operator">:</span> <span class="token number">0.6</span><span class="token punctuation">,</span> <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">&quot;rgb(250, 0, 0)&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> <span class="token literal-property property">ratio</span><span class="token operator">:</span> <span class="token number">0.85</span><span class="token punctuation">,</span> <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">&quot;rgb(250, 150, 0)&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> <span class="token literal-property property">ratio</span><span class="token operator">:</span> <span class="token number">0.95</span><span class="token punctuation">,</span> <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">&quot;rgb(255, 255, 0)&quot;</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token literal-property property">maxPixelIntensity</span><span class="token operator">:</span> <span class="token number">100</span><span class="token punctuation">,</span>
  <span class="token literal-property property">minPixelIntensity</span><span class="token operator">:</span> <span class="token number">10</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="dotdensityrenderer-点密度渲染"><a href="#dotdensityrenderer-点密度渲染" class="header-anchor">#</a> DotDensityRenderer（点密度渲染）</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">require</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&quot;esri/renderers/DotDensityRenderer&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">DotDensityRenderer</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">/* code goes here */</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>使用场景:
在面要素的渲染中，通过面内点的密集程度来表示某个属性字段的大小。</p> <p><strong>API 3.28</strong>
DotDensityRenderer常用属性介绍：</p> <table><thead><tr><th>值</th> <th>类型</th> <th>描述</th></tr></thead> <tbody><tr><td>backgroundColor</td> <td>Color</td> <td>面要素的背景色</td></tr> <tr><td>dotShape</td> <td>String</td> <td>点样式</td></tr> <tr><td>dotSize</td> <td>Number</td> <td>点大小</td></tr> <tr><td>dotValue</td> <td>Number</td> <td>一个点代表的值</td></tr> <tr><td>fields</td> <td>Object[]</td> <td>定义要映射的字段及其颜色</td></tr> <tr><td>outline</td> <td>LineSymbol</td> <td>点的外框</td></tr></tbody></table> <p>使用案例：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">new</span> <span class="token class-name">DotDensityRenderer</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">fields</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;M163_07&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Color</span><span class="token punctuation">(</span><span class="token string">&quot;#CC8800&quot;</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token literal-property property">dotValue</span><span class="token operator">:</span> <span class="token number">1600</span><span class="token punctuation">,</span>
  <span class="token literal-property property">dotSize</span><span class="token operator">:</span> <span class="token number">1</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p><strong>API 4.11 的不同之处</strong></p> <p>在4.11的版本中，更新了DotDensityRenderer这个渲染类型，其提供了两个新的属性，是在3.28里没有的，也比3.28的更好用了。</p> <table><thead><tr><th>值</th> <th>类型</th> <th>描述</th></tr></thead> <tbody><tr><td>dotBlendingEnabled</td> <td>Boolean</td> <td>当设置了多个fields的时候，颜色是覆盖还是叠加</td></tr> <tr><td>referenceScale</td> <td>Number</td> <td>渲染器将根据使用calculateDotValue（）方法根据地图比例的变化线性地重新计算点值，也即是dotValue</td></tr></tbody></table> <h3 id="scaledependentrenderer-不同比例尺不同渲染"><a href="#scaledependentrenderer-不同比例尺不同渲染" class="header-anchor">#</a> ScaleDependentRenderer（不同比例尺不同渲染）</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">require</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&quot;esri/renderers/ScaleDependentRenderer&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">ScaleDependentRenderer</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">/* code goes here */</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>使用场景:
在不同的地图比例尺中，执行不同的渲染方式。</p> <p><strong>API 3.28</strong>
HeatmapRenderer常用属性介绍：</p> <table><thead><tr><th>值</th> <th>类型</th> <th>描述</th></tr></thead> <tbody><tr><td>rangeType</td> <td>String</td> <td>判断依据是zoom还是scale</td></tr> <tr><td>rendererInfos</td> <td>Object</td> <td>定义不同缩放比例的渲染</td></tr></tbody></table> <p>使用案例：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> renderer1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DotDensityRenderer</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">fields</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;M163_07&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Color</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">52</span><span class="token punctuation">,</span> <span class="token number">114</span><span class="token punctuation">,</span> <span class="token number">53</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token literal-property property">dotValue</span><span class="token operator">:</span> <span class="token number">4000</span><span class="token punctuation">,</span>
  <span class="token literal-property property">dotSize</span><span class="token operator">:</span> <span class="token number">2</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> renderer2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DotDensityRenderer</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">fields</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;M163_07&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Color</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">52</span><span class="token punctuation">,</span> <span class="token number">114</span><span class="token punctuation">,</span> <span class="token number">53</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token literal-property property">dotValue</span><span class="token operator">:</span> <span class="token number">1000</span><span class="token punctuation">,</span>
  <span class="token literal-property property">dotSize</span><span class="token operator">:</span> <span class="token number">2</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> scaleDependentRenderer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ScaleDependentRenderer</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">rendererInfos</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
    <span class="token literal-property property">renderer</span><span class="token operator">:</span> renderer1<span class="token punctuation">,</span>
    <span class="token literal-property property">maxScale</span><span class="token operator">:</span> <span class="token number">10000000</span><span class="token punctuation">,</span>
    <span class="token literal-property property">minScale</span><span class="token operator">:</span> <span class="token number">20000000</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">renderer</span><span class="token operator">:</span> renderer2<span class="token punctuation">,</span>
    <span class="token literal-property property">maxScale</span><span class="token operator">:</span> <span class="token number">5000000</span><span class="token punctuation">,</span>
    <span class="token literal-property property">minScale</span><span class="token operator">:</span> <span class="token number">10000000</span>
  <span class="token punctuation">}</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>在4.11的API中是没有这个渲染类的，但是我们可以这样替代这个类</p> <div class="language-js extra-class"><pre class="language-js"><code>view<span class="token punctuation">.</span><span class="token function">watch</span><span class="token punctuation">(</span><span class="token string">&quot;scale&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">newValue</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    layer<span class="token punctuation">.</span>renderer <span class="token operator">=</span> newValue <span class="token operator">&lt;=</span> <span class="token number">5000000</span> <span class="token operator">?</span> simpleRenderer <span class="token operator">:</span> heatmapRenderer<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>同理，在3.x的API同样可以使用这个方法</p> <div class="language-js extra-class"><pre class="language-js"><code>map<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;zoom-end&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> Scale <span class="token operator">=</span> map<span class="token punctuation">.</span><span class="token function">getScale</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>Scale<span class="token operator">&lt;</span><span class="token number">300000</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    layer<span class="token punctuation">.</span><span class="token function">setRenderer</span><span class="token punctuation">(</span>renderer1<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    layer<span class="token punctuation">.</span><span class="token function">setRenderer</span><span class="token punctuation">(</span>renderer2<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="arcgis-api-事件"><a href="#arcgis-api-事件" class="header-anchor">#</a> Arcgis API 事件</h2> <h3 id="简介"><a href="#简介" class="header-anchor">#</a> 简介</h3> <p>API事件发生在用户与系统交互时，例如加载图层、操作鼠标等动作都会触发事件。我们可以通过监听事件并编写响应事件的代码使我们的系统更加具有交互性。</p> <h3 id="_1-layer事件"><a href="#_1-layer事件" class="header-anchor">#</a> 1. Layer事件</h3> <p><code>esri/layers/Layer</code>是所有图层类的父类</p> <p>Layer图层是Map对象的最基本组成部分，其拥有的事件有：</p> <table><thead><tr><th>事件名</th> <th>说明</th> <th>返回值</th></tr></thead> <tbody><tr><td>layerview-create</td> <td>在创建图层的LayerView并添加到View后触发。</td> <td>{ <br> View,<br> LayerView,<br> Layer<br>}</td></tr> <tr><td>layerview-destroy</td> <td>在图层的LayerView被销毁,不再在视图中渲染之后触发。</td> <td>{ <br>  View,<br> LayerView,<br>Layer<br>}</td></tr></tbody></table> <p>注：当一个layer添加到map后会实例化一个<code>esri/views/layers/LayerView</code>类。
LayerView是将单个图层添加到MapView或SceneView后的视图。</p> <h3 id="_2-view事件"><a href="#_2-view事件" class="header-anchor">#</a> 2. View事件</h3> <p><code>esri/views/View</code>是MapView和SceneView的父类</p> <table><thead><tr><th>事件名</th> <th>说明</th></tr></thead> <tbody><tr><td>鼠标点击事件</td> <td>一般为鼠标左键触发的操作</td></tr> <tr><td>click</td> <td>鼠标点击(mapPoint)</td></tr> <tr><td>immediate-click</td> <td>不受双击事件影响，鼠标左键后马上触发(mapPoint)</td></tr> <tr><td>double-click</td> <td>双击事件(mapPoint)</td></tr> <tr><td>pointer-down</td> <td>当鼠标按钮被按下，或者手指触碰到显示屏时触发。</td></tr> <tr><td>pointer-up</td> <td>释放鼠标按钮或显示触摸结束后触发。</td></tr> <tr><td>drag</td> <td>拖拽事件</td></tr> <tr><td>hold</td> <td>在短时间内按住鼠标按钮后触发。</td></tr> <tr><td>---</td> <td>---</td></tr> <tr><td>鼠标其他事件</td> <td>鼠标移动等操作触发的事件</td></tr> <tr><td>blur</td> <td>当浏览器焦点从view中移开时触发。</td></tr> <tr><td>focus</td> <td>当浏览器的焦点在view上时触发。</td></tr> <tr><td>mouse-wheel</td> <td>鼠标滚轮在视图上滚动时触发</td></tr> <tr><td>pointer-enter</td> <td>在鼠标光标进入视图，或手指触摸开始后触发。</td></tr> <tr><td>pointer-leave</td> <td>在鼠标离开视图，或手指触摸结束后触发。</td></tr> <tr><td>pointer-move</td> <td>在鼠标或手指移动后触发。</td></tr> <tr><td>---</td> <td>---</td></tr> <tr><td>其他事件</td> <td></td></tr> <tr><td>resize</td> <td>当view的dom元素的大小改变时触发。</td></tr> <tr><td>key-down</td> <td>按下键盘键后触发</td></tr> <tr><td>key-up</td> <td>释放键盘键后触发。</td></tr> <tr><td>layerview-create</td> <td>在每个图层都有相应的LayerView创建并在视图中呈现后触发。</td></tr> <tr><td>layerview-destroy</td> <td>在一个LayerView被销毁并且不再在视图中呈现后触发</td></tr></tbody></table> <h3 id="_3-api3-x与4-x的区别"><a href="#_3-api3-x与4-x的区别" class="header-anchor">#</a> 3. API3.x与4.x的区别</h3> <p>在3.x中
<strong>esri/layers/layer</strong> 类有</p> <p>refresh-interval-change
scale-range-change
scale-visibility-change
opacity-change
visibility-change</p> <p><strong>esri/map</strong> 类有</p> <p>basemap-change
extent-change
time-extent-change</p> <p>这些xxx-change的事件在4.x都移除了，如果想达到3.x这些事件的效果，只需要watch监听一下对应的xxx属性变化就好。（不局限于上面提到的属性，layer和view的所有属性都可以监听）</p> <p>例如，现在要监听地图的比例尺</p> <div class="language-js extra-class"><pre class="language-js"><code>view<span class="token punctuation">.</span><span class="token function">watch</span><span class="token punctuation">(</span><span class="token string">&quot;scale&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token parameter">newValue<span class="token punctuation">,</span> oldValue<span class="token punctuation">,</span> property<span class="token punctuation">,</span> object</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;回调函数有4个参数，新值，旧值，属性名称，发起事件的对象&quot;</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="_4-关于api-4-x的其他属性或事件"><a href="#_4-关于api-4-x的其他属性或事件" class="header-anchor">#</a> 4. 关于API 4.x的其他属性或事件</h3> <ul><li>如何知道map已经加载完成？</li></ul> <p>在<code>esri/views/View</code>中有when(callback, errback)函数。
当View类创建完成的时候，会触发回调函数。</p> <p>使用场景(当map初始化完成后，将map，view，以及地图组件本身传给其他组件使用)</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// map.vue中：</span>
mapView<span class="token punctuation">.</span><span class="token function">when</span><span class="token punctuation">(</span>
  lang<span class="token punctuation">.</span><span class="token function">hitch</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;地图创建完成&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>eventBus<span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">&quot;mapInitReady&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
      map<span class="token punctuation">,</span>
      mapView<span class="token punctuation">,</span>
      <span class="token literal-property property">mapComponents</span><span class="token operator">:</span> <span class="token keyword">this</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 工具组件：</span>
<span class="token function">beforeMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    EventBus<span class="token punctuation">.</span><span class="token function">$on</span><span class="token punctuation">(</span><span class="token string">&quot;mapInitReady&quot;</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>mapReadyHandler<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token literal-property property">methods</span><span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token function">mapReadyHandler</span><span class="token punctuation">(</span><span class="token parameter">para</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>map <span class="token operator">=</span> para<span class="token punctuation">.</span>map<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>mapView <span class="token operator">=</span> para<span class="token punctuation">.</span>mapView<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>mapComponents <span class="token operator">=</span> para<span class="token punctuation">.</span>mapComponents<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>layer从被添加到map，到最后显示到页面上经历了什么？</li></ul> <p>1.layer被添加到map对象后，首先会创建layerView，当layerView创建好后会发布<code>layerview-create</code>事件</p> <p>2.创建了layerView后，会获取layer数据，此时layer的updating属性为true</p> <p>3.获取完数据，updating属性变为false，表示数据获取完毕</p> <p>4.将数据渲染为canvas，添加到页面上</p> <p>使用场景举例(地图打印)</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>mapView<span class="token punctuation">.</span>updating <span class="token operator">||</span> <span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>mapView<span class="token punctuation">.</span>stationary<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> handle <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>mapView<span class="token punctuation">.</span><span class="token function">watch</span><span class="token punctuation">(</span><span class="token string">&quot;updating&quot;</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token parameter">newValue</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>newValue<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// updating变成false，表示已更新好视图，可以开始打印</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">Screenshot</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      handle<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">Screenshot</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">async</span> <span class="token function">Screenshot</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> screenshot <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> dataURL <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> viewType <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>mapComponents<span class="token punctuation">.</span><span class="token function">getViewType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 延时100ms,是因为updating变true的时候，还需要花时间将数据渲染成canvas</span>
  <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>viewType <span class="token operator">===</span> <span class="token string">&quot;2d&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      screenshot <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>mapComponents<span class="token punctuation">.</span><span class="token function">takeScreenshot</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      dataURL <span class="token operator">=</span> screenshot<span class="token punctuation">.</span><span class="token function">toDataURL</span><span class="token punctuation">(</span><span class="token string">&quot;image/jpeg&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      screenshot <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>mapView<span class="token punctuation">.</span><span class="token function">takeScreenshot</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      dataURL <span class="token operator">=</span> screenshot<span class="token punctuation">.</span>dataUrl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">const</span> aLink <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">&quot;a&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    aLink<span class="token punctuation">.</span>download <span class="token operator">=</span> <span class="token string">&quot;map.jpeg&quot;</span><span class="token punctuation">;</span>
    aLink<span class="token punctuation">.</span>href <span class="token operator">=</span> dataURL<span class="token punctuation">;</span>
    aLink<span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><ul><li>visible与suspended属性</li></ul> <p>suspended表示图层已经停止更新，当满足以下条件之一就为true</p> <ol><li>图层的visible为false</li> <li>图层在当前地图比例上不可见。</li></ol> <div class="to-top"><svg t="1547627942927" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1955" xmlns:xlink="http://www.w3.org/1999/xlink" width="64" height="64" class="icon"><path d="M752.736 431.063C757.159 140.575 520.41 8.97 504.518 0.41V0l-0.45 0.205-0.41-0.205v0.41c-15.934 8.56-252.723 140.165-248.259 430.653-48.21 31.457-98.713 87.368-90.685 184.074 8.028 96.666 101.007 160.768 136.601 157.287 35.595-3.482 25.232-30.31 25.232-30.31l12.206-50.095s52.47 80.569 69.304 80.528c15.114-1.23 87-0.123 95.6 0h0.82c8.602-0.123 80.486-1.23 95.6 0 16.794 0 69.305-80.528 69.305-80.528l12.165 50.094s-10.322 26.83 25.272 30.31c35.595 3.482 128.574-60.62 136.602-157.286 8.028-96.665-42.475-152.617-90.685-184.074z m-248.669-4.26c-6.758-0.123-94.781-3.359-102.891-107.192 2.95-98.714 95.97-107.438 102.891-107.93 6.964 0.492 99.943 9.216 102.892 107.93-8.11 103.833-96.174 107.07-102.892 107.192z m-52.019 500.531c0 11.838-9.42 21.382-21.012 21.382a21.217 21.217 0 0 1-21.054-21.34V821.74c0-11.797 9.421-21.382 21.054-21.382 11.591 0 21.012 9.585 21.012 21.382v105.635z m77.333 57.222a21.504 21.504 0 0 1-21.34 21.626 21.504 21.504 0 0 1-21.34-21.626V827.474c0-11.96 9.543-21.668 21.299-21.668 11.796 0 21.38 9.708 21.38 21.668v157.082z m71.147-82.043c0 11.796-9.42 21.34-21.053 21.34a21.217 21.217 0 0 1-21.013-21.34v-75.367c0-11.755 9.421-21.299 21.013-21.299 11.632 0 21.053 9.544 21.053 21.3v75.366z" fill="#3eaf7c" p-id="1956"></path></svg></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">6/13/2020, 5:41:03 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/./dailyRecord/OLSourceCode2.html" class="prev">
        OpenLayers 源码分析(下篇)
      </a></span> <span class="next"><a href="/./dailyRecord/GISsystem.html">
        GIS 体系介绍
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="./assets/js/app.78793606.js" defer></script><script src="./assets/js/3.9a8cb714.js" defer></script><script src="./assets/js/34.c6f368f7.js" defer></script><script src="./assets/js/17.7a89769a.js" defer></script>
  </body>
</html>
