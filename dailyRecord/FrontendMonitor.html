<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>前端异常监控实践 | Notebook</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="">
    <meta name="description" content="📝每天记录一点点">
    
    <link rel="preload" href="./assets/css/0.styles.81cbcbf8.css" as="style"><link rel="preload" href="./assets/js/app.78793606.js" as="script"><link rel="preload" href="./assets/js/3.9a8cb714.js" as="script"><link rel="preload" href="./assets/js/13.ab50e66a.js" as="script"><link rel="prefetch" href="./assets/js/10.3f7afedc.js"><link rel="prefetch" href="./assets/js/11.849f2ab3.js"><link rel="prefetch" href="./assets/js/12.f69c7e94.js"><link rel="prefetch" href="./assets/js/14.4b2fce32.js"><link rel="prefetch" href="./assets/js/15.8b353502.js"><link rel="prefetch" href="./assets/js/16.3195875f.js"><link rel="prefetch" href="./assets/js/17.7a89769a.js"><link rel="prefetch" href="./assets/js/18.fcadf835.js"><link rel="prefetch" href="./assets/js/19.231d3618.js"><link rel="prefetch" href="./assets/js/2.56707d7e.js"><link rel="prefetch" href="./assets/js/20.a85f560c.js"><link rel="prefetch" href="./assets/js/21.24336449.js"><link rel="prefetch" href="./assets/js/22.73659552.js"><link rel="prefetch" href="./assets/js/23.a091243a.js"><link rel="prefetch" href="./assets/js/24.c8ba16f0.js"><link rel="prefetch" href="./assets/js/25.882bb768.js"><link rel="prefetch" href="./assets/js/26.f04079ce.js"><link rel="prefetch" href="./assets/js/27.3ccd410f.js"><link rel="prefetch" href="./assets/js/28.58938703.js"><link rel="prefetch" href="./assets/js/29.a0b3a5cc.js"><link rel="prefetch" href="./assets/js/30.054f5cc9.js"><link rel="prefetch" href="./assets/js/31.2a2497ca.js"><link rel="prefetch" href="./assets/js/32.2fec2015.js"><link rel="prefetch" href="./assets/js/33.1c38360d.js"><link rel="prefetch" href="./assets/js/34.c6f368f7.js"><link rel="prefetch" href="./assets/js/35.eb21b972.js"><link rel="prefetch" href="./assets/js/36.d24643c3.js"><link rel="prefetch" href="./assets/js/37.64bf3a08.js"><link rel="prefetch" href="./assets/js/38.9456e466.js"><link rel="prefetch" href="./assets/js/39.d6639e8e.js"><link rel="prefetch" href="./assets/js/4.3e5912c4.js"><link rel="prefetch" href="./assets/js/40.0be61706.js"><link rel="prefetch" href="./assets/js/41.83d228f2.js"><link rel="prefetch" href="./assets/js/42.4a8c6e1b.js"><link rel="prefetch" href="./assets/js/43.ed4184d6.js"><link rel="prefetch" href="./assets/js/44.84f96688.js"><link rel="prefetch" href="./assets/js/45.99c1db7a.js"><link rel="prefetch" href="./assets/js/46.38462d37.js"><link rel="prefetch" href="./assets/js/47.18ad8970.js"><link rel="prefetch" href="./assets/js/5.07eb40e3.js"><link rel="prefetch" href="./assets/js/6.be2121ec.js"><link rel="prefetch" href="./assets/js/7.198c5ca7.js"><link rel="prefetch" href="./assets/js/8.0d657d1b.js"><link rel="prefetch" href="./assets/js/9.35e5878d.js">
    <link rel="stylesheet" href="./assets/css/0.styles.81cbcbf8.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/./" class="home-link router-link-active"><!----> <span class="site-name">Notebook</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/./dailyRecord/" class="nav-link router-link-active">
  📚学习总结
</a></div><div class="nav-item"><a href="/./bookmark/" class="nav-link">
  📌书签整理
</a></div><div class="nav-item"><a href="/./lint/" class="nav-link">
  ✔️编码规范&amp;协同开发
</a></div><div class="nav-item"><a href="http://shooterblog.site/Learn-JS-Demo/%E5%89%8D%E7%AB%AF%E7%9F%A5%E8%AF%86%E5%9B%BE%E8%B0%B1/index.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  📖知识脑图
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/./dailyRecord/" class="nav-link router-link-active">
  📚学习总结
</a></div><div class="nav-item"><a href="/./bookmark/" class="nav-link">
  📌书签整理
</a></div><div class="nav-item"><a href="/./lint/" class="nav-link">
  ✔️编码规范&amp;协同开发
</a></div><div class="nav-item"><a href="http://shooterblog.site/Learn-JS-Demo/%E5%89%8D%E7%AB%AF%E7%9F%A5%E8%AF%86%E5%9B%BE%E8%B0%B1/index.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  📖知识脑图
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>前端模块化和打包工具</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>前端异常监控</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/./dailyRecord/FrontendMonitor.html" aria-current="page" class="active sidebar-link">前端异常监控实践</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/./dailyRecord/FrontendMonitor.html#js-异常" class="sidebar-link">JS 异常</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/./dailyRecord/FrontendMonitor.html#js-异常的特点" class="sidebar-link">JS 异常的特点</a></li><li class="sidebar-sub-header"><a href="/./dailyRecord/FrontendMonitor.html#error-错误类型" class="sidebar-link">Error 错误类型</a></li></ul></li><li class="sidebar-sub-header"><a href="/./dailyRecord/FrontendMonitor.html#异常收集" class="sidebar-link">异常收集</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/./dailyRecord/FrontendMonitor.html#try-catch" class="sidebar-link">try-catch</a></li><li class="sidebar-sub-header"><a href="/./dailyRecord/FrontendMonitor.html#window-onerror" class="sidebar-link">window.onerror</a></li><li class="sidebar-sub-header"><a href="/./dailyRecord/FrontendMonitor.html#监听-error-事件" class="sidebar-link">监听 error 事件</a></li><li class="sidebar-sub-header"><a href="/./dailyRecord/FrontendMonitor.html#promise-异常捕获" class="sidebar-link">Promise 异常捕获</a></li><li class="sidebar-sub-header"><a href="/./dailyRecord/FrontendMonitor.html#async-await-异常捕获" class="sidebar-link">async/await 异常捕获</a></li><li class="sidebar-sub-header"><a href="/./dailyRecord/FrontendMonitor.html#小结" class="sidebar-link">小结</a></li></ul></li><li class="sidebar-sub-header"><a href="/./dailyRecord/FrontendMonitor.html#后续还在画饼中。。。" class="sidebar-link">后续还在画饼中。。。</a></li><li class="sidebar-sub-header"><a href="/./dailyRecord/FrontendMonitor.html#vue-项目异常收集" class="sidebar-link">VUE 项目异常收集</a></li><li class="sidebar-sub-header"><a href="/./dailyRecord/FrontendMonitor.html#前端录制回放" class="sidebar-link">前端录制回放</a></li><li class="sidebar-sub-header"><a href="/./dailyRecord/FrontendMonitor.html#异常筛选过滤及分类分析" class="sidebar-link">异常筛选过滤及分类分析</a></li><li class="sidebar-sub-header"><a href="/./dailyRecord/FrontendMonitor.html#上传错误信息和回放" class="sidebar-link">上传错误信息和回放</a></li><li class="sidebar-sub-header"><a href="/./dailyRecord/FrontendMonitor.html#后端信息收集入库" class="sidebar-link">后端信息收集入库</a></li><li class="sidebar-sub-header"><a href="/./dailyRecord/FrontendMonitor.html#前端搭建异常监控可视化管理平台" class="sidebar-link">前端搭建异常监控可视化管理平台</a></li></ul></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Vue3原理</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Vue3源码</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>内功修炼</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>总结</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>GIS</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="前端异常监控实践"><a href="#前端异常监控实践" class="header-anchor">#</a> 前端异常监控实践</h1> <h2 id="js-异常"><a href="#js-异常" class="header-anchor">#</a> JS 异常</h2> <h3 id="js-异常的特点"><a href="#js-异常的特点" class="header-anchor">#</a> JS 异常的特点</h3> <p>js 异常的特点是,出现不会导致 JS 引擎崩溃 最多只会终止当前执行的任务。</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
  <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;1-&gt;begin&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">&quot;手动抛出异常&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;1-&gt;end&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;2-&gt;begin&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;2-&gt;end&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>执行上面的例子，我们用 setTimeout 分别启动了两个任务，虽然第一个任务执行了一个错误的方法。程序执行停止了。但是另外一个任务并没有收到影响。</p> <p><img src="data:image/png;base64,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" alt="image"></p> <p>其实如果你不打开控制台都看不到发生了异常。好像是异常是在静默中发生的。所以我们需要对前端的异常进行收集监控，以便更好的对系统进行运维管理。</p> <h3 id="error-错误类型"><a href="#error-错误类型" class="header-anchor">#</a> Error 错误类型</h3> <p>代码执行过程中会发生各种类型的错误。每种类型都会对应一个错误发生时抛出的错误对象。</p> <h4 id="error"><a href="#error" class="header-anchor">#</a> Error</h4> <p>Error 是基类型，其他错误类型继承该类型。因此，所有错误类型都共享相同的属性（所有错误对象上的方法都是这个默认类型定义的方法）。</p> <p>浏览器很少会抛出 Error 类型的错误，该类型主要用于开发者抛出自定义错误。</p> <h4 id="internalerror"><a href="#internalerror" class="header-anchor">#</a> InternalError</h4> <p>InternalError 类型的错误会在底层 JavaScript 引擎抛出异常时由浏览器抛出。例如，递归过多导 致了栈溢出。这个类型并不是代码中通常要处理的错误，如果真发生了这种错误，很可能代码哪里弄错
了或者有危险了。</p> <h4 id="rangeerror"><a href="#rangeerror" class="header-anchor">#</a> RangeError</h4> <p>数值变量或参数超出其有效范围。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//RangeError: Maximum call stack size exceeded</span>

<span class="token keyword">let</span> item <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Array</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// RangeError: Invalid array length</span>
</code></pre></div><h4 id="referenceerror"><a href="#referenceerror" class="header-anchor">#</a> ReferenceError</h4> <p>引用变量不存在，无效引用。</p> <div class="language-js extra-class"><pre class="language-js"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ReferenceError: a is not defined</span>
</code></pre></div><h4 id="syntaxerror"><a href="#syntaxerror" class="header-anchor">#</a> SyntaxError</h4> <p>语法错误。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> c <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token string">&quot;&quot;</span> <span class="token comment">//SyntaxError: Unexpected string</span>
</code></pre></div><h4 id="typeerror"><a href="#typeerror" class="header-anchor">#</a> TypeError</h4> <p>变量或参数不属于有效类型。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
b<span class="token punctuation">.</span><span class="token function">xxx</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// TypeError: b.xxx is not a function</span>

<span class="token keyword">let</span> o <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">10</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// TypeError: 10 is not a constructor</span>
</code></pre></div><h4 id="urierror"><a href="#urierror" class="header-anchor">#</a> URIError</h4> <p>以一种错误的方式使用全局 URI 处理函数而产生的错误。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">decodeURI</span><span class="token punctuation">(</span><span class="token string">&quot;%&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// URIError: URI malformed</span>
</code></pre></div><h2 id="异常收集"><a href="#异常收集" class="header-anchor">#</a> 异常收集</h2> <h3 id="try-catch"><a href="#try-catch" class="header-anchor">#</a> try-catch</h3> <p>作为在 JavaScript 中处理异常的一种方式,任何可能出错的代码都应该放到 try 块中，而处理错误的代码则放在 catch 块中。</p> <p>如果在函数中错误没有被捕获，错误会上抛。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">fun1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;1-&gt;begin&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  error<span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;1-&gt;end&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">try</span> <span class="token punctuation">{</span>
    <span class="token function">fun1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAbIAAABKCAYAAADexdHcAAAYAUlEQVR4nO2de7BV4xvH33NOJLdQRu5EcqlIjJ+iacYllHKfXMZQZGgQcsvIYFRoJGZyqROZzJjQTLkV/sglMkIIJbmXn5lEouTnnPNbn7f9LO9eZ621115773POOuf5zOw5e6/Lu951Oe93Pc/7vM9b1eBhFEVRFCWjVDd3BRRFURSlFFTIFEVRlEyjQqYoiqJkGhUyRVEUJdOokCmKoiiZplUL2aZNm8x1111nnn322eauiqIoilIhShKyX3/91Zx99tmmf//+5quvviqpIuw/btw4Kz6KoiiKkpTUQobwjBkzxtx3332mW7duifd77733rJXUFILVoUMHM3nyZHPuuedW/FiKoihK85BayA488EBTW1trdtlll6L2O+aYY0zfvn3N2LFjQ8VswoQJ5oADDrCWHhafgGCynI/rKkQYZTkfsQ7d5UHX4tSpU83MmTMj1yuKoijZoVn6yLCQhg0bZi666KI8sVq4cKEZNGiQWbVqlV0/bdo0uxyh2X///e3yZcuWmXfeeccKFfs+/vjjZsGCBXbdFVdcYa6++morsggmyyZOnNjo+H/88YdZunSpLYt958+fn1cPRVEUJTtURMik7yzO4kFobrrpJjN06FC/f23AgAGmV69e9nvv3r2t4Kxbt84K1y233GLL6tGjh5k3b17JdUQocT126tTJ7LjjjiWXpyiKojQP7SpR6M4772yef/752G2wqHAXzp07124fDBb55ZdfzPbbb2/FZocddrCWE5aWC65JRGjgwIH295AhQ6xFpiiKorQdKiJkhcBCw8qaNWuWFaow3njjDetOZH3Pnj3NnDlzrAXnsnr1aityuAijylEURVFaN6ldi+I+POqoo2zfFlZRkmhELDFEbPz48Y3Eh3JwHeJCBIk2HDx4sPnpp598V6UEguy5555mw4YN/j58pA6IJb9xSYpbkmMriqIorYuqLE/jgjBhuYmlhrgxJODWW29t5IZUFEVRWieZzuxx0EEH5YXZYx2OHDlSRUxRWiD/nH66qX/xxbxl/P7n2GMjf5eb+unTbT0a1c07ZsPSpUWVVXfppabOe3FWmp9m6SMrF0mCShRFaX6sgK1da6oHD061P4JRdfDBpvqyy/zy6u+5J3af6hEj/O2FhkWLTHW/fo23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Lm4/VxzB6zBt2jR/37TPZLEgXrvvvrv1ZAThflAHzlP6DRWlNVO2YI9Ro0b5/zw0Orheiumo5037lFNOsa7KqM7/IPwzMyP0wIEDiwowwOKiEejRo0dekEOhOuDGKUf4vVwvrFjKov4333xzRayNNPciikrUWwJRJNhCAjTcYAU+nIO419KAGxDxkuAMXKquWxGX6MMPP5zoGnEd2F+CQ3iORBTTPpNR1yHpOQWfY1yLnCfj0kbksmgoSmulio6y5q6EoiiKoqSlLBaZoiiKojQXKmSKoihKplEhUxRFUTKNCpmiKIqSaVTIWgClJKxtq6xfv96MHj3aLF26tLmrkikklVilhwcoSlOSeSErNvO4S7ky8Ev+wSQh00HkuBIKLg00QwTkU8nGmjFQlSifMil78+bNZsKECfY7yPm9/PLLZT+mlM/x+FtJ4q5bmjpwPdLcb+rBPu71lGse9gwxdODiiy+263X2BqW10GbnIytXBn7KoVFAFMePH1/0vgzAnuQkJIXddtvN3HnnnaZjx46p69WS2Hbbbe1fGlhSRh122GEll8m1efDBB0sup6Vw2mmn2Y8IfiG4lg888IA59dRTQ9dzze+//36z3377NVon4yU5ls7moLQGMiFkNPjDhw83q1evtr8ljRTiIbnmJLdd0vRAYRn4g3nwxFriWHzfuHGjqa2ttfWQ49AosCzN2y2ZJmhQgimGouCtmjyR1OPDDz+06cBE8Fh3T27GW3c5b+q4k1566SWzYcMGc/LJJ9uBtO72r776aqP93PVHHnmkuf7660379u3NrFmz7LVhIC5ceumltgGGb7/91uZk5DjAsf766y9b37322ssOav76669Nt27dzMqVK+02WC133HGHf29vu+02c8QRR9iyXnvtNbN27dpG58o5PZHLxSfbAw2znMtluQzkcr7S8FNWsN6Ut27dOju1CvVwzzeOVatWmYceesier5QXVYfzzjvPziYAnPugQYPsNXTrEQflci2kXnx4TuH9998vuH8Q8lFK/sykz5+itFQyIWRuolwaZSwg0kkhJDRS/EPi90/yDxkURYSQhnB6gikfEMu5uRlox4wZY8tKm9WC8/j000+tmyfIzz//7DeC5Erk3OTN+uOPP7a/acRogBctWmQOPfRQ89xzz9lzEBGi0aTRg7feestP4MtbOiLBOSPONJBHH320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" alt="image"></p> <p>但是 try/catch 对异步代码就显得无能为力了,除非给所有的异步都再加一个 try-catch（代码改动巨大）。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">fun1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;1-&gt;begin&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  error<span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;1-&gt;end&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">try</span> <span class="token punctuation">{</span>
  <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">fun1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;catch&quot;</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="window-onerror"><a href="#window-onerror" class="header-anchor">#</a> window.onerror</h3> <p>任何没有被 try/catch 语句处理的错误都会在 window 对象上触发 error 事件，不管是同步还是异步。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">fun1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;1-&gt;begin&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">&quot;error&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;1-&gt;end&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
window<span class="token punctuation">.</span><span class="token function-variable function">onerror</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>args</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;onerror:&quot;</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 返回true 可以阻止浏览器报告这个错误</span>
  <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">fun1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>在 onerror 事件处理程序中，会传入 5 个参数：</p> <ol><li>message</li> <li>发生错误的 URL</li> <li>行号</li> <li>列号</li> <li>错误 event 对象</li></ol> <p><img src="./assets/img/03.56bb4f9d.png" alt="image"></p> <h3 id="监听-error-事件"><a href="#监听-error-事件" class="header-anchor">#</a> 监听 error 事件</h3> <p>其实 onerror 固然好但是还是有一类异常无法捕获。这就是网络异常的错误。比如下面的例子。</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>./xx.png<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
</code></pre></div><p>注意，当资源（如 img 或 script）加载失败，加载资源的元素会执行该元素上的 onerror()处理函数。这些 error 事件不会向上冒泡到 window，但可以在捕获阶段被捕获。所以需要在捕获阶段捕获事件。</p> <div class="language-js extra-class"><pre class="language-js"><code>window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span>
  <span class="token string">&quot;error&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token parameter">args</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;error event:&quot;</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token boolean">true</span> <span class="token comment">// 捕获阶段</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><img src="./assets/img/04.ddf4697c.png" alt="image"></p> <h3 id="promise-异常捕获"><a href="#promise-异常捕获" class="header-anchor">#</a> Promise 异常捕获</h3> <p>ES 6 原生提供了 Promise 对象。Promise 对象代表了未来将要发生的事件，用来传递异步操作的消息。</p> <p>这种无论是 onerror 还是监听错误事件都是无法捕获 Promise。除非每个 Promise 都添加一个 catch 方法，但是显然是不能这样做。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">&quot;error&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// 增加异常捕获</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;promise catch:&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>我们可以考虑将 unhandledrejection 事件捕获错误抛出交由错误事件统一处理就可以了</p> <div class="language-js extra-class"><pre class="language-js"><code>window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;unhandledrejection&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">throw</span> e<span class="token punctuation">.</span>reason<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>可以看到 unhandledrejection 事件是可以拿到错误信息的</p> <p><img src="./assets/img/05.86d91681.png" alt="image"></p> <p>拿到错误信息后直接 throw 将错误抛出，window.onerror 就会收集到错误信息统一处理。</p> <h3 id="async-await-异常捕获"><a href="#async-await-异常捕获" class="header-anchor">#</a> async/await 异常捕获</h3> <p>实际上 async/await 语法本质还是 Promise 语法。区别就是 async 方法可以被上层的 try/catch 捕获。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token function-variable function">asyncFunc</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">&quot;error&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">try</span> <span class="token punctuation">{</span>
    <span class="token keyword">await</span> <span class="token function">asyncFun</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 会捕获到 asyncFunc 的错误</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;catch:&quot;</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>如果不用 try/catch，就会和 Promise 一样，需要用 unhandledrejection 事件捕获。这样的话我们只需要在全局增加 unhandlerejection 就好了。</p> <h3 id="小结"><a href="#小结" class="header-anchor">#</a> 小结</h3> <table><thead><tr><th>异常类型</th> <th>同步方法</th> <th>异常类型</th> <th>资源加载</th> <th>Promise</th> <th>async/await</th></tr></thead> <tbody><tr><td>try/catch</td> <td>√</td> <td>×</td> <td>×</td> <td>×</td> <td>×</td></tr> <tr><td>onerror</td> <td>√</td> <td>√</td> <td>×</td> <td>×</td> <td>×</td></tr> <tr><td>error 事件监听</td> <td>√</td> <td>√</td> <td>√</td> <td>×</td> <td>×</td></tr> <tr><td>unhandledrejection 事件监听</td> <td>×</td> <td>×</td> <td>×</td> <td>√</td> <td>√</td></tr></tbody></table> <p>实际上我们可以将 unhandledrejection 事件抛出的异常再次抛出就可以统一通过 error 事件进行处理了。</p> <p>最终用代码表示如下：</p> <div class="language-js extra-class"><pre class="language-js"><code>window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;unhandledrejection&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// 抛出错误到 error事件 统一处理</span>
  <span class="token keyword">throw</span> e<span class="token punctuation">.</span>reason<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span>
  <span class="token string">&quot;error&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token parameter">args</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;error event:&quot;</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token boolean">true</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="后续还在画饼中。。。"><a href="#后续还在画饼中。。。" class="header-anchor">#</a> 后续还在画饼中。。。</h2> <h2 id="vue-项目异常收集"><a href="#vue-项目异常收集" class="header-anchor">#</a> VUE 项目异常收集</h2> <h2 id="前端录制回放"><a href="#前端录制回放" class="header-anchor">#</a> 前端录制回放</h2> <h2 id="异常筛选过滤及分类分析"><a href="#异常筛选过滤及分类分析" class="header-anchor">#</a> 异常筛选过滤及分类分析</h2> <h2 id="上传错误信息和回放"><a href="#上传错误信息和回放" class="header-anchor">#</a> 上传错误信息和回放</h2> <h2 id="后端信息收集入库"><a href="#后端信息收集入库" class="header-anchor">#</a> 后端信息收集入库</h2> <h2 id="前端搭建异常监控可视化管理平台"><a href="#前端搭建异常监控可视化管理平台" class="header-anchor">#</a> 前端搭建异常监控可视化管理平台</h2></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">5/15/2021, 1:21:11 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/./dailyRecord/vite.html" class="prev">
        vite
      </a></span> <span class="next"><a href="/./dailyRecord/VUE3Reactivity.html">
        VUE3 响应式原理
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="./assets/js/app.78793606.js" defer></script><script src="./assets/js/3.9a8cb714.js" defer></script><script src="./assets/js/13.ab50e66a.js" defer></script>
  </body>
</html>
